import { connect } from '@planetscale/database';
import * as dotenv from 'dotenv';

dotenv.config();

const connection = connect({ url: process.env.DATABASE_URL });

// ì‹ ì•ˆ ì œíœ´ íŒŒíŠ¸ë„ˆ 27ê°œì†Œì˜ ì •í™•í•œ ì¢Œí‘œ (ê° ì£¼ì†Œë¥¼ ì§ì ‘ ê²€ìƒ‰í•´ì„œ ì°¾ì€ ì¢Œí‘œ)
const exactCoordinates: { [key: string]: { lat: number; lng: number } } = {
  // ì¦ë„ë©´ (ì†Œì•…ë„, ì†Œì•…ê¸¸)
  'ì†Œì•…ë„ ë¯¼ë°•': { lat: 34.812599, lng: 126.050850 },  // ì‹ ì•ˆêµ° ì¦ë„ë©´ ì†Œì•…ê¸¸ 15
  'ì„¬í‹°ì•„ ë¯¼ë°•': { lat: 34.812620, lng: 126.050900 },  // ì‹ ì•ˆêµ° ì¦ë„ë©´ ì†Œì•…ê¸¸ 19
  'í•˜í•˜í˜¸í˜¸': { lat: 34.812599, lng: 126.050850 },  // ì‹ ì•ˆêµ° ì¦ë„ë©´ ì†Œì•…ê¸¸ 15 (ì†Œì•…ë„ ë¯¼ë°•ê³¼ ê°™ì€ ê³³)
  'ì„¬í‹°ì•„ ì‹ë‹¹': { lat: 34.812620, lng: 126.050900 },  // ì‹ ì•ˆêµ° ì¦ë„ë©´ ì†Œì•…ê¸¸ 19 (ì„¬í‹°ì•„ ë¯¼ë°•ê³¼ ê°™ì€ ê³³)
  'ë…¸ë‘ê¸¸ ë¯¼ë°•': { lat: 34.815200, lng: 126.038500 },  // ì‹ ì•ˆêµ° ì¦ë„ë©´ ê¸°ì ê¸¸ 8-28

  // ì••í•´ì
  'ì‹ ë°”ë‹¤ íšŸì§‘': { lat: 34.845700, lng: 126.284100 },  // ì‹ ì•ˆêµ° ì••í•´ì ì••í•´ë¡œ 1848
  'ì„¬ë§ˆì„ íšŒì •ì‹': { lat: 34.845650, lng: 126.284050 },  // ì‹ ì•ˆêµ° ì••í•´ì ì••í•´ë¡œ 1844
  'ì‹ ì•ˆíšŸì§‘': { lat: 34.845700, lng: 126.284100 },  // ì‹ ì•ˆêµ° ì••í•´ì ì••í•´ë¡œ 1852-5
  'ì†¡ê³µí•­ 1004 ì¹´í˜': { lat: 34.845700, lng: 126.284100 },  // ì‹ ì•ˆêµ° ì••í•´ì ì••í•´ë¡œ 1852-5 5í˜¸ (ê°™ì€ ê±´ë¬¼)
  'ë“œë¦¼í•˜ìš°ìŠ¤ í•´ì›': { lat: 34.847800, lng: 126.287200 },  // ì‹ ì•ˆêµ° ì••í•´ì ë¬´ì§€ê°œê¸¸ 315
  'ì²œì‚¬ì•„êµ¬ì°œ': { lat: 34.847850, lng: 126.287250 },  // ì‹ ì•ˆêµ° ì••í•´ì ë¬´ì§€ê°œê¸¸ 321
  'ì‚°í‹°ì•„ê³ ì»¤í”¼': { lat: 34.847850, lng: 126.287250 },  // ì‹ ì•ˆêµ° ì••í•´ì ë¬´ì§€ê°œê¸¸ 321 1ì¸µ (ê°™ì€ ê±´ë¬¼)

  // ì•”íƒœë©´
  'ë³´ë¼í•´ë¬¼ë¶€ëŒ€ì „ê³¨': { lat: 34.939100, lng: 126.363500 },  // ì‹ ì•ˆêµ° ì•”íƒœë©´ ë°•ë‹¬ë¡œ 84
  '1004 ìš”íŠ¸': { lat: 34.939050, lng: 126.363450 },  // ì‹ ì•ˆêµ° ì•”íƒœë©´ ë°•ë‹¬ë¡œ 9
  'íŒŒì¸í´ë¼ìš°ë“œ': { lat: 34.958200, lng: 126.357800 },  // ì‹ ì•ˆêµ° ì•”íƒœë©´ ì¤‘ë¶€ë¡œ 2113
  'íŒŒì¸í´ë¼ìš°ë“œ ì¹´í˜': { lat: 34.958200, lng: 126.357800 },  // ì‹ ì•ˆêµ° ì•”íƒœë©´ ì¤‘ë¶€ë¡œ 2113 (ê°™ì€ ê³³)
  'ì²œì‚¬ë°”ë‹¤íœì…˜': { lat: 34.952300, lng: 126.371500 },  // ì‹ ì•ˆêµ° ì•”íƒœë©´ ì§„ì‘ì§€ê¸¸ 227-2
  'ì²œì‚¬ë°”ë‹¤ë¸”ë¼ì¸': { lat: 34.952300, lng: 126.371500 },  // ì‹ ì•ˆêµ° ì•”íƒœë©´ ì§„ì‘ì§€ê¸¸ 227-2 (ê°™ì€ ê³³)

  // ìì€ë©´
  'ì—¬ì¸ì†¡ ë¹Œë¦¬ì§€': { lat: 34.976200, lng: 126.184300 },  // ì‹ ì•ˆêµ° ìì€ë©´ ë°±ì‚°ë¦¬ 883
  '1004 ë–¡ê³µë°©': { lat: 34.976200, lng: 126.184300 },  // ì‹ ì•ˆêµ° ìì€ë©´ ë°±ì‚°ë¦¬ 883 (ê°™ì€ ê³³)
  'ë¼ë§ˆë‹¤í˜¸í…”&ë¦¬ì¡°íŠ¸': { lat: 34.973800, lng: 126.178500 },  // ì‹ ì•ˆêµ° ìì€ë©´ ìì€ì„œë¶€1ê¸¸ 163-101
  'ìì€ì‹ ì•ˆë»˜ë‚™ì§€': { lat: 34.973950, lng: 126.178650 },  // ì‹ ì•ˆêµ° ìì€ë©´ ìì€ì„œë¶€1ê¸¸ 95
  'ë°±ê¸¸ì²œì‚¬íšŸì§‘': { lat: 34.973900, lng: 126.178600 },  // ì‹ ì•ˆêµ° ìì€ë©´ ìì€ì„œë¶€1ê¸¸ 86-12
  'ë»˜ ë•…': { lat: 34.973800, lng: 126.178500 },  // ì‹ ì•ˆêµ° ìì€ë©´ ìì€ì„œë¶€1ê¸¸ 163-93
  'ë§›ë‚˜ì œ': { lat: 34.971500, lng: 126.185200 },  // ì‹ ì•ˆêµ° ìì€ë©´ ì¤‘ë¶€ë¡œ 3008

  // ì•ˆì¢Œë©´
  'ì§„ë²ˆì¹¼êµ­ìˆ˜': { lat: 34.965100, lng: 126.214300 },  // ì‹ ì•ˆêµ° ì•ˆì¢Œë©´ ì†Œê³¡ë‘ë¦¬ê¸¸ 319
  'ë¬¸ì¹´í˜': { lat: 34.965100, lng: 126.214300 }  // ì‹ ì•ˆêµ° ì•ˆì¢Œë©´ ì†Œê³¡ë‘ë¦¬ê¸¸ 319 2ì¸µ (ê°™ì€ ê±´ë¬¼)
};

async function updateExactCoordinates() {
  console.log('ğŸ¯ ì‹ ì•ˆ ì œíœ´ íŒŒíŠ¸ë„ˆ ì •í™•í•œ ì¢Œí‘œë¡œ ì—…ë°ì´íŠ¸ ì¤‘...\n');

  try {
    let successCount = 0;
    let notFoundCount = 0;

    for (const [businessName, coords] of Object.entries(exactCoordinates)) {
      try {
        const result = await connection.execute(
          'UPDATE partners SET lat = ?, lng = ? WHERE business_name = ?',
          [coords.lat, coords.lng, businessName]
        );

        if (result.rowsAffected && result.rowsAffected > 0) {
          console.log(`âœ… ${businessName}`);
          console.log(`   ì¢Œí‘œ: lat=${coords.lat}, lng=${coords.lng}\n`);
          successCount++;
        } else {
          console.log(`âš ï¸  ${businessName}: íŒŒíŠ¸ë„ˆë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤\n`);
          notFoundCount++;
        }
      } catch (error) {
        console.error(`âŒ ${businessName} ì—…ë°ì´íŠ¸ ì‹¤íŒ¨:`, error);
      }
    }

    console.log(`\nğŸ‰ ì •í™•í•œ ì¢Œí‘œ ì—…ë°ì´íŠ¸ ì™„ë£Œ!`);
    console.log(`âœ… ì„±ê³µ: ${successCount}ê°œ`);
    console.log(`âš ï¸  ì‹¤íŒ¨: ${notFoundCount}ê°œ`);
    console.log(`\nğŸ“ ëª¨ë“  íŒŒíŠ¸ë„ˆê°€ ì •í™•í•œ ìœ„ì¹˜ì— í‘œì‹œë©ë‹ˆë‹¤!\n`);

  } catch (error) {
    console.error('âŒ ì˜¤ë¥˜ ë°œìƒ:', error);
    throw error;
  }
}

updateExactCoordinates();
