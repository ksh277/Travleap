# 🧪 완벽한 테스트 - 모든 기능 실제 검증

## 📌 테스트 목표
실제 API 키 없이도 **완벽하게 동작하는지** 확인합니다.

---

## ✅ 테스트 1: 개발 서버 시작

```bash
# 터미널에서
cd c:\Users\ham57\Desktop\Travleap
npm run dev
```

**기대 결과:**
```
VITE v5.x.x  ready in xxx ms

➜  Local:   http://localhost:5173/
➜  Network: use --host to expose
```

**✅ 확인:**
- [ ] 서버가 에러 없이 시작됨
- [ ] http://localhost:5173 접속 가능

---

## ✅ 테스트 2: 관리자 로그인

### 브라우저 콘솔 (F12)
```javascript
adminLogin()
```

**기대 결과:**
```
🚀 관리자 로그인 시도...
✅ 관리자 로그인 성공!
```

**✅ 확인:**
- [ ] URL이 `/admin`으로 변경됨
- [ ] 관리자 페이지가 표시됨
- [ ] 상단에 "관리자 대시보드" 표시

---

## ✅ 테스트 3: PMS 연동 모달 열기

### 단계:
1. **"상품 관리"** 탭 클릭
2. **"+ 상품 추가"** 버튼 클릭
3. **카테고리 드롭다운** → **"숙박"** 선택
4. **"PMS 연동"** 버튼 클릭

**기대 결과:**
- 모달이 열림
- 제목: "PMS 연동 - 숙박 정보 불러오기"
- 3개 입력 필드:
  - PMS 공급업체 (CloudBeds 기본 선택)
  - 호텔 ID
  - API Key
- 2개 버튼:
  - "PMS에서 데이터 불러오기"
  - **"테스트 데이터 사용"** (파란색 외곽선)

**✅ 확인:**
- [ ] 모달이 정상 표시됨
- [ ] "테스트 데이터 사용" 버튼 보임

---

## ✅ 테스트 4: 테스트 데이터 로드

### 단계:
**"테스트 데이터 사용"** 버튼 클릭

**기대 결과 (1초 안에):**

### 토스트 메시지:
```
✅ 테스트 데이터가 로드되었습니다!
```

### 모달 내용 변경:
```
┌─────────────────────────────────────────┐
│ 2️⃣ 불러온 데이터 확인                    │
├─────────────────────────────────────────┤
│ 호텔 정보                                │
│ ───────────────────────────────────    │
│ 호텔명: 신안 비치 호텔                   │
│ 위치: 전라남도 신안군 압해읍              │
│ 객실 타입: 3개                           │
├─────────────────────────────────────────┤
│ 객실 타입 (3개)                          │
│ ───────────────────────────────────    │
│ ✅ Deluxe Double                        │
│    💰 평균 요금: 120,000 KRW            │
│    🛏️ 침대: Queen | 최대: 2명           │
│    📦 재고: 8 / 10                      │
│                                         │
│ ✅ Family Suite                         │
│    💰 평균 요금: 250,000 KRW            │
│    🛏️ 침대: King + Twin | 최대: 4명    │
│    📦 재고: 3 / 5                       │
│                                         │
│ ✅ Standard Twin                        │
│    💰 평균 요금: 90,000 KRW             │
│    🛏️ 침대: Twin | 최대: 2명            │
│    📦 재고: 12 / 15                     │
├─────────────────────────────────────────┤
│ [  폼에 적용하기  ]                      │
└─────────────────────────────────────────┘
```

**✅ 확인:**
- [ ] 3개 객실 타입 정확히 표시됨
- [ ] 가격, 침대 타입, 재고 모두 표시됨
- [ ] "폼에 적용하기" 버튼 활성화됨

---

## ✅ 테스트 5: 폼에 적용

### 단계:
**"폼에 적용하기"** 버튼 클릭

**기대 결과:**

### 토스트 메시지:
```
✅ PMS 데이터가 폼에 적용되었습니다! 필요한 항목만 수정 후 "상품 추가"를 눌러주세요.
```

### 모달 닫힘 + 상품 추가 폼 자동 입력:
```
상품 추가 폼:
───────────────────────────────────────
제목: [신안 비치 호텔]

카테고리: [숙박] (회색으로 비활성화)

위치: [전라남도 신안군 압해읍]

설명: [아름다운 바다 전망과 함께 편안한 휴식을 즐길 수 있는 신안 대표 호텔입니다.]

이미지:
  - https://images.unsplash.com/photo-1566073771259-6a8506099945?w=800
  - https://images.unsplash.com/photo-1582719478250-c89cae4dc85b?w=800

가격: [120000]

최대 인원: [2]

하이라이트 (3개):
  1. [Deluxe Double - 120,000원 (최대 2명)]
  2. [Family Suite - 250,000원 (최대 4명)]
  3. [Standard Twin - 90,000원 (최대 2명)]
```

**✅ 확인:**
- [ ] 모든 필드가 자동으로 채워짐
- [ ] 하이라이트에 3개 객실 정보 정확함
- [ ] 이미지 URL 2개 입력됨

---

## ✅ 테스트 6: 상품 DB 저장

### 단계:
스크롤 아래로 → **"상품 추가"** 버튼 클릭

**기대 결과:**

### 브라우저 콘솔 (자동 로그):
```
🏨 PMS 상품 저장 시작...
DB에 상품 저장 중... {hotelName: "신안 비치 호텔", ...}
✅ DB 저장 완료: Listing ID = 1
```

### 토스트 메시지:
```
✅ PMS 연동 숙박 상품이 등록되었습니다!
```

### 상품 목록에 추가됨:
```
상품 관리 탭 - 상품 목록:
┌──────────────────────────────────┐
│ 신안 비치 호텔                    │
│ 카테고리: 숙박                    │
│ 가격: ₩120,000                   │
│ 상태: ✅ 활성                     │
│ [수정] [삭제]                     │
└──────────────────────────────────┘
```

**✅ 확인:**
- [ ] 콘솔에 "DB 저장 완료" 로그
- [ ] 토스트 메시지 표시
- [ ] 상품 목록에 추가됨
- [ ] 폼이 초기화됨 (빈 상태로)

---

## ✅ 테스트 7: DB 확인 (6개 테이블)

### 브라우저 콘솔에서 실행:

```javascript
// 1. Listings 테이블
db.findAll('listings').then(r => {
  console.log('📊 Listings:', r.length, '개');
  console.table(r);
});

// 2. PMS 설정
db.findAll('pms_configs').then(r => {
  console.log('🔧 PMS Configs:', r.length, '개');
  console.table(r);
});

// 3. 객실 타입
db.findAll('room_types').then(r => {
  console.log('🛏️ Room Types:', r.length, '개');
  console.table(r);
});

// 4. 객실 이미지
db.findAll('room_media').then(r => {
  console.log('📷 Room Media:', r.length, '개');
  console.table(r);
});

// 5. 요금 플랜
db.findAll('rate_plans').then(r => {
  console.log('💰 Rate Plans:', r.length, '개');
  console.table(r);
});

// 6. 재고 (30일)
db.findAll('room_inventory').then(r => {
  console.log('📦 Room Inventory:', r.length, '개');
  console.log('날짜 범위:', r[0]?.date, '~', r[r.length-1]?.date);
  console.table(r.slice(0, 5)); // 처음 5개만
});
```

**기대 결과:**
```
📊 Listings: 1 개
┌─────┬──────┬─────────────────┬────────┬───────────┬───────────┐
│ id  │ title│ category        │ price_from│ price_to │ location │
├─────┼──────┼─────────────────┼────────┼───────────┼───────────┤
│ 1   │ 신안 비치 호텔 │ 숙박  │ 90000  │ 250000   │ 전라남도...│
└─────┴──────┴─────────────────┴────────┴───────────┴───────────┘

🔧 PMS Configs: 1 개
┌─────┬────────────┬──────────┬──────────────┐
│ id  │ listing_id │ vendor   │ hotel_id     │
├─────┼────────────┼──────────┼──────────────┤
│ 1   │ 1          │ cloudbeds│ test_hotel_001│
└─────┴────────────┴──────────┴──────────────┘

🛏️ Room Types: 3 개
┌─────┬────────────┬──────────────────┬──────────┬──────────┐
│ id  │ listing_id │ room_type_name   │ max_occ  │ bed_type │
├─────┼────────────┼──────────────────┼──────────┼──────────┤
│ 1   │ 1          │ Deluxe Double    │ 2        │ Queen    │
│ 2   │ 1          │ Family Suite     │ 4        │ King+Twin│
│ 3   │ 1          │ Standard Twin    │ 2        │ Twin     │
└─────┴────────────┴──────────────────┴──────────┴──────────┘

📷 Room Media: 3 개 (각 객실당 1개)

💰 Rate Plans: 3 개
┌─────┬──────────────┬────────────┬─────────┐
│ id  │ room_type_id │ base_price │ currency│
├─────┼──────────────┼────────────┼─────────┤
│ 1   │ 1            │ 120000     │ KRW     │
│ 2   │ 2            │ 250000     │ KRW     │
│ 3   │ 3            │ 90000      │ KRW     │
└─────┴──────────────┴────────────┴─────────┘

📦 Room Inventory: 90 개
날짜 범위: 2025-10-10 ~ 2025-11-09
(3개 객실 × 30일 = 90개)
```

**✅ 확인:**
- [ ] listings: 1개
- [ ] pms_configs: 1개
- [ ] room_types: 3개
- [ ] room_media: 3개
- [ ] rate_plans: 3개
- [ ] room_inventory: 90개

---

## ✅ 테스트 8: 카테고리 페이지 확인

### 브라우저 주소창:
```
http://localhost:5173/category/accommodation
```

**기대 결과:**

### 페이지 제목:
```
숙박 - Travleap | 신안 여행
총 1개 상품
```

### AccommodationCard 표시:
```
┌─────────────────────────────────────┐
│  [호텔 이미지]                       │
│  🟢 실시간 예약                      │
│                                     │
├─────────────────────────────────────┤
│  신안 비치 호텔                      │
│  📍 전라남도 신안군 압해읍            │
│                                     │
│  ⭐ 0.0 (0)                         │
│                                     │
│  ┌───────────────────────────┐     │
│  │ 객실 타입                  │     │
│  │ Deluxe Double - 120,000원  │     │
│  │ (최대 2명)                 │     │
│  │ Family Suite - 250,000원   │     │
│  │ (최대 4명)                 │     │
│  └───────────────────────────┘     │
│                                     │
│  ₩90,000 ~ ₩250,000                │
│  1박 기준                           │
│                                     │
│  [WiFi] [에어컨] [TV] [조식]        │
│                                     │
└─────────────────────────────────────┘
```

**✅ 확인:**
- [ ] AccommodationCard 스타일로 표시됨 (일반 카드 아님!)
- [ ] "실시간 예약" 초록 배지
- [ ] 객실 타입 박스에 2개 표시 (Deluxe, Family)
- [ ] 가격 범위: ₩90,000 ~ ₩250,000
- [ ] "1박 기준" 텍스트

### 개발자 도구 - Network 탭 확인:
```
Request: GET /api/listings?category=stay&page=1&limit=20
Response: 200 OK
{
  "success": true,
  "data": [
    {
      "id": 1,
      "title": "신안 비치 호텔",
      "highlights": [
        "Deluxe Double - 120,000원 (최대 2명)",
        "Family Suite - 250,000원 (최대 4명)",
        "Standard Twin - 90,000원 (최대 2명)"
      ],
      ...
    }
  ]
}
```

**✅ 확인:**
- [ ] API 요청 성공 (200 OK)
- [ ] highlights에 객실 정보 포함

---

## ✅ 테스트 9: 상세 페이지 이동

### 단계:
카드 클릭 (아무 곳이나)

**기대 결과:**

### URL 변경:
```
http://localhost:5173/accommodation/1
```

### 페이지 구성:
```
┌─────────────────────────────────────────────────┐
│                                                 │
│  [      메인 이미지 (큰 사이즈)      ]          │
│  ← 1 / 2 →                                      │
│                                                 │
│  [썸네일1] [썸네일2]                            │
│                                                 │
├─────────────────────────────────────────────────┤
│  신안 비치 호텔                        ❤️ 🔗    │
│  📍 전라남도 신안군 압해읍                       │
│  ⭐ 0.0 (0)  🟢 실시간 예약                     │
│                                                 │
│  아름다운 바다 전망과 함께 편안한 휴식을...     │
│                                                 │
├─────────────────────────────────────────────────┤
│  객실 선택                                      │
│  ┌────────────────────────────────────┐       │
│  │ Deluxe Double          ₩120,000     │       │
│  │ 👥 최대 2명            1박 기준     │       │
│  └────────────────────────────────────┘       │
│  ┌────────────────────────────────────┐       │
│  │ Family Suite           ₩250,000     │       │
│  │ 👥 최대 4명            1박 기준     │       │
│  └────────────────────────────────────┘       │
│  ┌────────────────────────────────────┐       │
│  │ Standard Twin          ₩90,000      │       │
│  │ 👥 최대 2명            1박 기준     │       │
│  └────────────────────────────────────┘       │
├─────────────────────────────────────────────────┤
│  편의시설                                       │
│  📶 WiFi  ❄️ 에어컨  📺 TV  ☕ 조식           │
└─────────────────────────────────────────────────┘

                           [우측 사이드바]
                           ┌────────────────┐
                           │ 1박 기준        │
                           │ ₩90,000 ~      │
                           │                │
                           │ 체크인          │
                           │ [📅 날짜 선택] │
                           │                │
                           │ 체크아웃        │
                           │ [📅 날짜 선택] │
                           │                │
                           │ 인원            │
                           │ [-] 2명 [+]    │
                           │                │
                           │ [바로 예약하기] │
                           │                │
                           │ 실시간 예약 -   │
                           │ 즉시 확정됩니다 │
                           └────────────────┘
```

**✅ 확인:**
- [ ] 이미지 갤러리 작동 (좌/우 화살표)
- [ ] 3개 객실 카드 모두 표시
- [ ] 사이드바 표시 (sticky)
- [ ] "바로 예약하기" 버튼

---

## ✅ 테스트 10: 객실 선택

### 단계:
**"Family Suite"** 카드 클릭

**기대 결과:**
```
선택한 객실:
┌────────────────────────────────────┐
│ Family Suite           ₩250,000    │  ← 파란색 테두리
│ 👥 최대 4명            1박 기준    │  ← 파란색 배경
└────────────────────────────────────┘

다른 객실:
┌────────────────────────────────────┐
│ Deluxe Double          ₩120,000    │  ← 회색 테두리
│ 👥 최대 2명            1박 기준    │
└────────────────────────────────────┘
```

### 다시 **"Deluxe Double"** 클릭:
```
┌────────────────────────────────────┐
│ Deluxe Double          ₩120,000    │  ← 이제 파란색
│ 👥 최대 2명            1박 기준    │
└────────────────────────────────────┘

┌────────────────────────────────────┐
│ Family Suite           ₩250,000    │  ← 다시 회색
│ 👥 최대 4명            1박 기준    │
└────────────────────────────────────┘
```

**✅ 확인:**
- [ ] 클릭한 객실만 파란색 테두리
- [ ] 다른 객실 클릭 시 색상 이동
- [ ] 하나만 선택 가능

---

## ✅ 테스트 11: 날짜 선택

### 단계:
1. **"체크인"** 필드 클릭
2. 달력에서 **내일** 클릭

**기대 결과:**
```
체크인: 2025년 10월 11일
```

### 단계:
3. **"체크아웃"** 필드 클릭
4. 달력에서 **3일 후** 클릭

**기대 결과:**
```
체크아웃: 2025년 10월 13일
```

### 날짜 비활성화 확인:
- 체크인: 오늘 이전 날짜 클릭 안 됨 (회색)
- 체크아웃: 체크인 이전 날짜 클릭 안 됨 (회색)

**✅ 확인:**
- [ ] 달력 팝업 정상 작동
- [ ] 과거 날짜 비활성화
- [ ] 선택한 날짜 표시됨

---

## ✅ 테스트 12: 인원 조정

### 초기 상태:
```
인원: 2명
```

### '+' 버튼 3번 클릭:
```
인원: 5명
```

### '-' 버튼 10번 클릭:
```
인원: 1명 (더 이상 감소 안 됨)
```

### '+' 버튼 10번 클릭:
```
인원: 10명 (최대)
```

**✅ 확인:**
- [ ] +/- 버튼 작동
- [ ] 최소 1명
- [ ] 최대 10명

---

## ✅ 테스트 13: 유효성 검사

### 시나리오 1: 객실 미선택
```
체크인: ✅ 선택
체크아웃: ✅ 선택
객실: ❌ 미선택
```
**"바로 예약하기"** 클릭

**기대 결과:**
```
🔴 객실 타입을 선택해주세요
```

### 시나리오 2: 날짜 미선택
```
체크인: ❌ 미선택
체크아웃: ❌ 미선택
객실: ✅ Deluxe Double
```
**"바로 예약하기"** 클릭

**기대 결과:**
```
🔴 체크인/체크아웃 날짜를 선택해주세요
```

**✅ 확인:**
- [ ] 유효성 검사 작동
- [ ] 에러 토스트 표시

---

## ✅ 테스트 14: 예약 (결제 페이지 이동)

### 모든 정보 입력:
```
객실: Deluxe Double (₩120,000/박)
체크인: 2025-10-11
체크아웃: 2025-10-13 (2박)
인원: 2명
```

### **"바로 예약하기"** 클릭

**기대 결과:**

### URL 즉시 변경:
```
http://localhost:5173/payment
```

### localStorage 확인 (콘솔):
```javascript
JSON.parse(localStorage.getItem('booking_data'))
```

**결과:**
```json
{
  "listingId": 1,
  "listingTitle": "신안 비치 호텔",
  "roomType": "Deluxe Double",
  "roomPrice": 120000,
  "checkIn": "2025-10-11",
  "checkOut": "2025-10-13",
  "nights": 2,
  "guests": 2,
  "totalPrice": 240000,
  "image": "https://images.unsplash.com/...",
  "location": "전라남도 신안군 압해읍"
}
```

**✅ 확인:**
- [ ] /payment 페이지로 이동
- [ ] localStorage에 데이터 저장됨
- [ ] nights = 2 (정확히 계산됨)
- [ ] totalPrice = 240,000 (120,000 × 2)

---

## ✅ 테스트 15: 결제 페이지 확인

### 현재 PaymentPage (기본):
```
결제 페이지가 표시됨 (기존 PaymentPage 컴포넌트)
```

### localStorage 데이터 사용 (추가 구현 필요):
결제 페이지에서 `localStorage.getItem('booking_data')`로 정보 가져와야 함

**✅ 확인:**
- [ ] /payment 페이지 표시됨
- [ ] localStorage에 booking_data 존재

---

## 🎯 최종 체크리스트

### PMS 상품 등록:
- [ ] ✅ 관리자 로그인 작동
- [ ] ✅ PMS 모달 열림
- [ ] ✅ 테스트 데이터 로드 (3개 객실)
- [ ] ✅ 폼에 자동 입력
- [ ] ✅ DB 6개 테이블에 저장

### 카테고리 페이지:
- [ ] ✅ AccommodationCard 표시
- [ ] ✅ 객실 타입 2개 미리보기
- [ ] ✅ 가격 범위 정확
- [ ] ✅ "실시간 예약" 배지

### 상세 페이지:
- [ ] ✅ 이미지 갤러리 작동
- [ ] ✅ 3개 객실 선택 카드
- [ ] ✅ 객실 선택 (파란색 테두리)
- [ ] ✅ 날짜 선택 (달력)
- [ ] ✅ 인원 조정 (+/-)
- [ ] ✅ 유효성 검사

### 예약 플로우:
- [ ] ✅ 바로 예약하기 버튼
- [ ] ✅ localStorage 저장
- [ ] ✅ /payment 이동
- [ ] ✅ 총 금액 자동 계산

---

## 🔥 전체 테스트 스크립트 (복사해서 실행)

```javascript
// 브라우저 콘솔에서 한 번에 실행

console.log('🧪 전체 테스트 시작...\n');

// 1. DB 초기화 확인
console.log('1️⃣ DB 확인...');
db.findAll('listings').then(r => {
  console.log(`   Listings: ${r.length}개`);
});

// 2. 관리자 로그인
console.log('2️⃣ 관리자 로그인...');
setTimeout(() => adminLogin(), 1000);

// 3. 안내
console.log('3️⃣ 다음 단계:');
console.log('   - 상품 관리 → 상품 추가');
console.log('   - 카테고리: 숙박');
console.log('   - PMS 연동 → 테스트 데이터 사용');
console.log('   - 폼에 적용하기 → 상품 추가');
console.log('');

// 4. 저장 후 확인
console.log('4️⃣ 저장 후 실행할 코드:');
console.log(`
// DB 확인
Promise.all([
  db.findAll('listings'),
  db.findAll('pms_configs'),
  db.findAll('room_types'),
  db.findAll('room_media'),
  db.findAll('rate_plans'),
  db.findAll('room_inventory')
]).then(([listings, configs, rooms, media, rates, inventory]) => {
  console.table({
    'Listings': listings.length,
    'PMS Configs': configs.length,
    'Room Types': rooms.length,
    'Room Media': media.length,
    'Rate Plans': rates.length,
    'Room Inventory': inventory.length
  });
});

// 카테고리 페이지 이동
location.href = '/category/accommodation';
`);

console.log('\n✅ 준비 완료! 위 단계를 따라 테스트하세요.\n');
```

---

## 📋 오류 발생 시 체크

### 오류 1: "PMS 연동 버튼이 안 보여요"
- **원인**: 카테고리가 "숙박"이 아님
- **해결**: 카테고리 드롭다운을 "숙박"으로 변경

### 오류 2: "테스트 데이터 사용 버튼이 안 보여요"
- **원인**: PMSIntegrationModal 미적용
- **해결**: 파일 저장 후 새로고침 (Ctrl+R)

### 오류 3: "상품이 카테고리 페이지에 안 보여요"
- **원인**: DB에 저장 안 됨 또는 is_active=false
- **해결**:
  ```javascript
  db.findAll('listings').then(r => {
    if (r.length === 0) {
      console.log('❌ 저장 안 됨! 다시 등록하세요');
    } else {
      console.log('✅ 저장됨:', r[0].title);
      if (!r[0].is_active) {
        console.log('⚠️ is_active=false → true로 변경 필요');
      }
    }
  });
  ```

### 오류 4: "AccommodationCard가 아니라 일반 카드가 나와요"
- **원인**: CategoryPage 코드 미적용
- **해결**: CategoryPage.tsx 저장 후 새로고침

### 오류 5: "객실 타입이 안 보여요"
- **원인**: highlights 형식 오류
- **해결**:
  ```javascript
  db.findOne('listings', {id: 1}).then(listing => {
    console.log('Highlights:', listing.highlights);
    // 기대: ["Deluxe Double - 120,000원 (최대 2명)", ...]
  });
  ```

---

## 🎉 성공 기준

모든 체크박스에 ✅가 있으면 **완벽하게 작동**합니다!

**총 체크박스: 50개**
- PMS 등록: 10개
- 카테고리 페이지: 10개
- 상세 페이지: 15개
- 예약 플로우: 15개

**50/50 = 100% 완성!** 🎊
