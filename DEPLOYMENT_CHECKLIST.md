# 배포 체크리스트 ✅

## 최근 배포 내역
- **Commit 1**: `760e228` - 소셜 로그인 CORS 문제 수정 및 카테고리 페이지 복원
- **Commit 2**: `95ced3a` - JSON 파싱 에러 및 관리자 페이지 개선

## 배포 후 테스트 순서

### 1. Vercel 배포 확인
- Vercel 대시보드에서 배포 상태 확인
- URL: https://vercel.com/dashboard
- 최신 커밋 `95ced3a`가 "Ready" 상태인지 확인

### 2. 소셜 로그인 테스트 (우선순위 높음)

#### 네이버 로그인
- [ ] 로그인 페이지 접속
- [ ] 네이버 로그인 버튼 클릭
- [ ] 팝업창에서 네이버 로그인
- [ ] ❌ "Failed to fetch" 에러가 사라졌는지 확인
- [ ] ✅ 정상 로그인 및 홈으로 리다이렉트 확인

#### 카카오 로그인
- [ ] 카카오 로그인 버튼 클릭
- [ ] 팝업창에서 카카오 로그인
- [ ] ❌ JSON 파싱 에러가 사라졌는지 확인
- [ ] ✅ 정상 로그인 확인
- [ ] 브라우저 콘솔에서 에러 로그 확인

#### 구글 로그인
- [ ] **먼저 Google Cloud Console 설정 필요**
  - URL: https://console.cloud.google.com/
  - APIs & Services > Credentials
  - OAuth 2.0 Client ID 선택
  - "승인된 리디렉션 URI"에 추가:
    - `https://travelap.vercel.app/api/auth/callback/google`
    - `http://localhost:5173/api/auth/callback/google` (개발용)
- [ ] 설정 후 구글 로그인 테스트
- [ ] ❌ "redirect_uri_mismatch" 에러 사라짐 확인
- [ ] ✅ 정상 로그인 확인

### 3. 장바구니 테스트

#### 로그인한 사용자
- [ ] 로그인 상태 확인
- [ ] 장바구니 페이지 접속
- [ ] 브라우저 개발자 도구 > Console 열기
- [ ] 로그 확인:
  ```
  🛒 [장바구니] API에서 로드 시작, user_id: XXX
  ✅ 장바구니 항목 로드 성공
  ```
- [ ] ❌ JSON 파싱 에러 없음 확인
- [ ] ✅ 장바구니 상품 정상 표시 확인

#### 상품 추가/삭제
- [ ] 상품 페이지에서 장바구니 추가
- [ ] 장바구니에서 수량 변경
- [ ] 장바구니에서 상품 삭제
- [ ] 모든 작업에서 에러 없음 확인

### 4. 카테고리 페이지 테스트
- [ ] 홈 페이지에서 카테고리 탭 확인
- [ ] 다음 카테고리들이 모두 표시되는지 확인:
  - [ ] 여행상품
  - [ ] 숙박
  - [ ] 렌터카
  - [ ] 맛집
  - [ ] 관광지
  - [ ] 패키지
  - [ ] 행사
  - [ ] 팝업
  - [ ] 체험
- [ ] 각 카테고리 클릭 시 상품 카드 표시 확인

### 5. 관리자 페이지 - 숙박 관리

#### 관리자 로그인
- [ ] 관리자 계정으로 로그인
- [ ] 관리자 페이지 접속
- [ ] "숙박 관리" 탭 클릭

#### 콘솔 로그 확인
- [ ] 브라우저 개발자 도구 > Console 열기
- [ ] 다음 로그 중 하나 확인:
  ```
  📥 숙박 업체 목록 로드 중...
  📦 API 응답: { success: true, data: [...] }
  ✅ 숙박 업체 X개 로드됨
  ```
  또는
  ```
  📥 숙박 업체 목록 로드 중...
  📦 API 응답: { success: true, data: [] }
  ℹ️ 등록된 숙박 업체가 없습니다
  ```

#### 데이터 확인
- [ ] 업체 목록이 표시되면: ✅ 정상
- [ ] 빈 목록이면: 데이터베이스에 `partner_type='lodging'` 레코드 없음
  - [ ] "업체 추가" 버튼으로 테스트 데이터 생성

### 6. Vercel 환경변수 재확인

다음 환경변수가 Vercel에 설정되어 있는지 확인:

```
VITE_GOOGLE_OAUTH_CLIENT_ID=Y142354823287-...
VITE_KAKAO_APP_KEY=0bcdf9416b3fc90c2669e52d23ed1a12
VITE_NAVER_CLIENT_ID=[네이버에서 발급받은 ID]

DATABASE_URL=[PlanetScale MySQL]
POSTGRES_DATABASE_URL=[Neon PostgreSQL]
JWT_SECRET=[비밀키]
```

## 문제 발생 시 디버깅

### JSON 파싱 에러가 계속 나는 경우
1. 브라우저 콘솔에서 네트워크 탭 열기
2. 실패한 API 요청 찾기
3. Response 탭에서 실제 응답 확인
4. Headers 탭에서 `Content-Type` 확인
5. 콘솔 로그에서 상세 에러 메시지 확인:
   ```
   ❌ 소셜 로그인: JSON이 아닌 응답 받음
   응답 내용: [처음 200자 표시]
   ```

### 장바구니가 안 로드되는 경우
1. 로그인 상태 확인 (localStorage에 `auth_token` 있는지)
2. 네트워크 탭에서 `/api/cart` 요청 확인
3. 401 에러면: Authorization 헤더 누락 (코드 재확인)
4. 500 에러면: 서버 로그 확인 (Vercel 대시보드)

### 관리자 숙박업체가 안 보이는 경우
1. 콘솔 로그 확인:
   - "✅ 숙박 업체 0개 로드됨" → 데이터 없음 (정상)
   - "❌ API 호출 실패: 500" → 서버 에러 (Vercel 로그 확인)
2. 데이터베이스 직접 확인:
   ```sql
   SELECT * FROM partners WHERE partner_type = 'lodging';
   ```

## 완료 시점
- [ ] 모든 소셜 로그인 정상 작동
- [ ] 장바구니 에러 없음
- [ ] 카테고리 페이지 모두 표시
- [ ] 관리자 페이지 정상 작동
- [ ] 브라우저 콘솔에 에러 없음

---

**마지막 업데이트**: 2025-11-06
**배포 커밋**: 95ced3a
