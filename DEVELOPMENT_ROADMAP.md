# ğŸš€ Travleap ì¹´í…Œê³ ë¦¬ë³„ ê¸°ëŠ¥ ê°œë°œ ë¡œë“œë§µ

> **ì‘ì„±ì¼**: 2025-10-31
> **ëª©ì **: 8ê°œ ì¹´í…Œê³ ë¦¬ë³„ í•„ìˆ˜ ê¸°ëŠ¥ êµ¬í˜„ì„ ìœ„í•œ ìƒì„¸ ê°€ì´ë“œ
> **ì§„í–‰ ë°©ì‹**: ë‹¨ê³„ë³„ë¡œ ì²œì²œíˆ, í•˜ë‚˜ì”© ì™„ì„±

---

## ğŸ“‹ ëª©ì°¨

1. [ê°œë°œ ìš°ì„ ìˆœìœ„ ë° ì „ì²´ ê³„íš](#ê°œë°œ-ìš°ì„ ìˆœìœ„-ë°-ì „ì²´-ê³„íš)
2. [Phase 1: ë ŒíŠ¸ì¹´ - ì‚¬ê³  ì‹ ê³  ì›í„°ì¹˜](#phase-1-ë ŒíŠ¸ì¹´---ì‚¬ê³ -ì‹ ê³ -ì›í„°ì¹˜)
3. [Phase 2: ìˆ™ë°• - ìº˜ë¦°ë” ì¬ê³  ê´€ë¦¬](#phase-2-ìˆ™ë°•---ìº˜ë¦°ë”-ì¬ê³ -ê´€ë¦¬)
4. [Phase 3: ì—¬í–‰ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•](#phase-3-ì—¬í–‰---ì „ì²´-ì‹œìŠ¤í…œ-êµ¬ì¶•)
5. [Phase 4: ìŒì‹ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•](#phase-4-ìŒì‹---ì „ì²´-ì‹œìŠ¤í…œ-êµ¬ì¶•)
6. [Phase 5: ì²´í—˜ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•](#phase-5-ì²´í—˜---ì „ì²´-ì‹œìŠ¤í…œ-êµ¬ì¶•)
7. [Phase 6: í–‰ì‚¬ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•](#phase-6-í–‰ì‚¬---ì „ì²´-ì‹œìŠ¤í…œ-êµ¬ì¶•)
8. [Phase 7: ê´€ê´‘ì§€ - ì…ì¥ê¶Œ ì‹œìŠ¤í…œ êµ¬ì¶•](#phase-7-ê´€ê´‘ì§€---ì…ì¥ê¶Œ-ì‹œìŠ¤í…œ-êµ¬ì¶•)
9. [ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸](#ê°œë°œ-ì²´í¬ë¦¬ìŠ¤íŠ¸)

---

## ê°œë°œ ìš°ì„ ìˆœìœ„ ë° ì „ì²´ ê³„íš

### ğŸ¯ ì‘ì—… ë²”ìœ„ ìš”ì•½

| Phase | ì¹´í…Œê³ ë¦¬ | ì‘ì—… ë‚´ìš© | ì˜ˆìƒ ê¸°ê°„ | ë‚œì´ë„ |
|-------|---------|----------|----------|--------|
| 1 | ë ŒíŠ¸ì¹´ | ì‚¬ê³  ì‹ ê³  ì›í„°ì¹˜ ê¸°ëŠ¥ | 2-3ì¼ | â­â­ |
| 2 | ìˆ™ë°• | ìº˜ë¦°ë” ì¬ê³  ê´€ë¦¬ ì‹œìŠ¤í…œ | 3-4ì¼ | â­â­â­ |
| 3 | ì—¬í–‰ | íŒ¨í‚¤ì§€/ìŠ¬ë¡¯/ë°”ìš°ì²˜ ì „ì²´ | 7-10ì¼ | â­â­â­â­â­ |
| 4 | ìŒì‹ | ë©”ë‰´/ì£¼ë¬¸/QR ì „ì²´ | 5-7ì¼ | â­â­â­â­ |
| 5 | ì²´í—˜ | ìŠ¬ë¡¯/ë©´ì±…/ë‚ ì”¨ ì „ì²´ | 5-7ì¼ | â­â­â­â­ |
| 6 | í–‰ì‚¬ | ì¢Œì„/í‹°ì¼“/QR ì „ì²´ | 5-7ì¼ | â­â­â­â­ |
| 7 | ê´€ê´‘ì§€ | ì…ì¥ê¶Œ/ê²Œì´íŠ¸ê²€ì¦ | 3-4ì¼ | â­â­â­ |

**ì´ ì˜ˆìƒ ê¸°ê°„**: ì•½ 30-42ì¼ (1-1.5ê°œì›”)

### âš ï¸ ì£¼ì˜ì‚¬í•­

- **íŒì—… ì¹´í…Œê³ ë¦¬**: í˜„ì¬ ìƒíƒœ ìœ ì§€ (ì‘ì—… ì—†ìŒ)
- **ë ŒíŠ¸ì¹´**: ê¸°ì¡´ ê¸°ëŠ¥ ìœ ì§€, ì‚¬ê³  ì‹ ê³ ë§Œ ì¶”ê°€
- **ìƒì„¸ í˜ì´ì§€**: ì—¬í–‰, ìŒì‹, ì²´í—˜, í–‰ì‚¬, ê´€ê´‘ì§€ëŠ” ì¹´í…Œê³ ë¦¬ë³„ ì»¤ìŠ¤í…€ í•„ìš”
- **ì ì§„ì  ë°°í¬**: ê° Phase ì™„ë£Œ í›„ í…ŒìŠ¤íŠ¸ â†’ ë°°í¬ â†’ ë‹¤ìŒ Phase

---

## Phase 1: ë ŒíŠ¸ì¹´ - ì‚¬ê³  ì‹ ê³  ì›í„°ì¹˜

### ğŸ“Œ ëª©í‘œ
ë Œí„°ì¹´ ì´ìš© ì¤‘ ì‚¬ê³  ë°œìƒ ì‹œ ì•±ì—ì„œ ì¦‰ì‹œ ì‹ ê³ í•˜ê³ , ë³´í—˜ì‚¬/ì—…ì²´/ê´€ë¦¬ìì—ê²Œ ìë™ ì•Œë¦¼

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 1.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/add-accident-report-system.sql`

```sql
-- ì‚¬ê³  ì‹ ê³  í…Œì´ë¸” ìƒì„±
CREATE TABLE IF NOT EXISTS accident_reports (
  id INT AUTO_INCREMENT PRIMARY KEY,

  -- ì˜ˆì•½ ì •ë³´
  booking_id INT NOT NULL,
  vehicle_id INT NOT NULL,
  vendor_id INT NOT NULL,
  user_id INT NOT NULL,

  -- ì‚¬ê³  ê¸°ë³¸ ì •ë³´
  report_number VARCHAR(50) UNIQUE NOT NULL COMMENT 'ì‹ ê³ ë²ˆí˜¸ (ACC-20250131-0001)',
  accident_datetime DATETIME NOT NULL COMMENT 'ì‚¬ê³  ë°œìƒ ì‹œê°',
  location_address VARCHAR(500) COMMENT 'ì‚¬ê³  ì¥ì†Œ',
  location_lat DECIMAL(10, 8),
  location_lng DECIMAL(11, 8),

  -- ì‚¬ê³  ìƒì„¸
  accident_type ENUM('collision', 'scratch', 'breakdown', 'theft', 'other') NOT NULL,
  severity ENUM('minor', 'moderate', 'severe') DEFAULT 'minor',
  description TEXT COMMENT 'ì‚¬ê³  ê²½ìœ„ ì„¤ëª…',

  -- ìƒëŒ€ë°© ì •ë³´ (ìˆëŠ” ê²½ìš°)
  other_party_name VARCHAR(100),
  other_party_phone VARCHAR(50),
  other_party_vehicle VARCHAR(100),
  police_report_filed BOOLEAN DEFAULT FALSE,
  police_report_number VARCHAR(100),

  -- ì¦ê±° ìë£Œ
  photos JSON COMMENT 'ì‚¬ê³  ì‚¬ì§„ URLs',
  videos JSON COMMENT 'ë¸”ë™ë°•ìŠ¤/ë™ì˜ìƒ URLs',

  -- ë³´í—˜ ì²˜ë¦¬
  insurance_claim_filed BOOLEAN DEFAULT FALSE,
  insurance_company VARCHAR(200),
  insurance_claim_number VARCHAR(100),
  estimated_damage_krw INT,

  -- ì²˜ë¦¬ ìƒíƒœ
  status ENUM('reported', 'investigating', 'claim_filed', 'resolved', 'closed') DEFAULT 'reported',
  handled_by INT COMMENT 'ì²˜ë¦¬ ë‹´ë‹¹ì ID',
  resolution_notes TEXT,

  -- ì•Œë¦¼ ê¸°ë¡
  vendor_notified_at DATETIME,
  insurance_notified_at DATETIME,
  admin_notified_at DATETIME,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_booking (booking_id),
  INDEX idx_vehicle (vehicle_id),
  INDEX idx_user (user_id),
  INDEX idx_report_number (report_number),
  INDEX idx_status (status),
  INDEX idx_accident_date (accident_datetime),

  FOREIGN KEY (booking_id) REFERENCES rentcar_bookings(id) ON DELETE CASCADE,
  FOREIGN KEY (vehicle_id) REFERENCES rentcar_vehicles(id),
  FOREIGN KEY (user_id) REFERENCES users(id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

#### 1.2 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`api/rentcar/accident/report.js`** - ì‚¬ê³  ì‹ ê³  ì ‘ìˆ˜
```javascript
// POST /api/rentcar/accident/report
// ì‚¬ê³  ì‹ ê³  ìƒì„± + ì‚¬ì§„ ì—…ë¡œë“œ + ìë™ ì•Œë¦¼ ë°œì†¡
```

2. **`api/rentcar/accident/[reportId].js`** - ì‚¬ê³  ì¡°íšŒ/ìˆ˜ì •
```javascript
// GET /api/rentcar/accident/[reportId] - ì‹ ê³  ìƒì„¸ ì¡°íšŒ
// PATCH /api/rentcar/accident/[reportId] - ì‹ ê³  ìˆ˜ì • (ì¶”ê°€ ì¦ê±° ë“±)
```

3. **`api/rentcar/accident/list.js`** - ì‚¬ê³  ëª©ë¡
```javascript
// GET /api/rentcar/accident/list?booking_id=123
// ì‚¬ìš©ì/ì—…ì²´ë³„ ì‚¬ê³  ë‚´ì—­
```

4. **`api/admin/rentcar/accidents.js`** - ê´€ë¦¬ì ì‚¬ê³  ê´€ë¦¬
```javascript
// GET /api/admin/rentcar/accidents - ì „ì²´ ì‚¬ê³  ëª©ë¡
// PATCH /api/admin/rentcar/accidents/[id]/status - ìƒíƒœ ë³€ê²½
```

#### 1.3 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/rentcar/AccidentReportButton.tsx`**
   - ë ŒíŠ¸ì¹´ ì´ìš© ì¤‘ í™”ë©´ì— ê¸´ê¸‰ ë²„íŠ¼ í‘œì‹œ
   - í´ë¦­ ì‹œ ì‚¬ê³  ì‹ ê³  í¼ ëª¨ë‹¬ ì˜¤í”ˆ

2. **`components/rentcar/AccidentReportForm.tsx`**
   - ì‚¬ê³  íƒ€ì… ì„ íƒ (ì ‘ì´‰ì‚¬ê³ /ì°¨ëŸ‰ ê³ ì¥/ë„ë‚œ ë“±)
   - ìœ„ì¹˜ ìë™ ê°ì§€ (GPS)
   - ì‚¬ì§„/ë™ì˜ìƒ ì—…ë¡œë“œ (ìµœëŒ€ 10ì¥)
   - ì‚¬ê³  ê²½ìœ„ ì‘ì„±
   - ìƒëŒ€ë°© ì •ë³´ ì…ë ¥ (ì„ íƒ)

3. **`components/rentcar/AccidentReportDetail.tsx`**
   - ì‹ ê³  ë‚´ì—­ ìƒì„¸ ì¡°íšŒ
   - ì§„í–‰ ìƒíƒœ íƒ€ì„ë¼ì¸
   - ë³´í—˜ì‚¬ ì—°ë½ì²˜ í‘œì‹œ

4. **`components/admin/AccidentManagement.tsx`**
   - ê´€ë¦¬ììš© ì‚¬ê³  ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ
   - ìƒíƒœë³„ í•„í„°ë§
   - ì²˜ë¦¬ ë‹´ë‹¹ì ë°°ì •

#### 1.4 ì•Œë¦¼ ì‹œìŠ¤í…œ

**íŒŒì¼**: `api/rentcar/accident/notifications.js`

```javascript
// ì‚¬ê³  ì‹ ê³  ì‹œ ìë™ ì•Œë¦¼ ë°œì†¡
// 1. ì—…ì²´ ë‹´ë‹¹ì (SMS + ì´ë©”ì¼)
// 2. ë³´í—˜ì‚¬ (API ì—°ë™ ë˜ëŠ” ì´ë©”ì¼)
// 3. ê´€ë¦¬ì ì•Œë¦¼ ì‹œìŠ¤í…œ
// 4. ì‚¬ìš©ì SMS (ì‹ ê³ ë²ˆí˜¸ ì „ì†¡)
```

#### 1.5 í†µí•© ì§€ì 

**ìˆ˜ì •í•  íŒŒì¼**:

1. **`components/RentcarBookingsPage.tsx`**
   - "ì´ìš© ì¤‘" ìƒíƒœì—ì„œ "ì‚¬ê³  ì‹ ê³ " ë²„íŠ¼ ì¶”ê°€

2. **`components/pages/RentcarVehicleDetailPage.tsx`**
   - ì˜ˆì•½ ì™„ë£Œ í›„ ì•ˆë‚´ ë¬¸êµ¬ì— "ì‚¬ê³  ì‹œ ì•± ë‚´ ì‹ ê³  ê¸°ëŠ¥ ì´ìš©" ì¶”ê°€

3. **`components/admin/RentcarManagement.tsx`**
   - "ì‚¬ê³  ê´€ë¦¬" íƒ­ ì¶”ê°€ (ì„ íƒì‚¬í•­)

---

## Phase 2: ìˆ™ë°• - ìº˜ë¦°ë” ì¬ê³  ê´€ë¦¬

### ğŸ“Œ ëª©í‘œ
ë‚ ì§œë³„ ê°ì‹¤ ê°€ìš©ì„± ê´€ë¦¬, ë™ì  ê°€ê²© ì„¤ì •, ì‹¤ì‹œê°„ ì¬ê³  ì—…ë°ì´íŠ¸

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 2.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/add-accommodation-calendar-inventory.sql`

```sql
-- ê°ì‹¤ ì¬ê³  ìº˜ë¦°ë” í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS room_availability (
  id BIGINT AUTO_INCREMENT PRIMARY KEY,

  room_id INT NOT NULL,
  date DATE NOT NULL,

  -- ì¬ê³ 
  total_rooms INT NOT NULL COMMENT 'ì´ ê°ì‹¤ ìˆ˜',
  available_rooms INT NOT NULL COMMENT 'ì˜ˆì•½ ê°€ëŠ¥ ê°ì‹¤ ìˆ˜',
  booked_rooms INT DEFAULT 0 COMMENT 'ì˜ˆì•½ëœ ê°ì‹¤ ìˆ˜',
  blocked_rooms INT DEFAULT 0 COMMENT 'íŒë§¤ ì¤‘ì§€ ê°ì‹¤ ìˆ˜',

  -- ë™ì  ê°€ê²©
  base_price_krw INT NOT NULL,
  weekend_price_krw INT,
  holiday_price_krw INT,
  special_price_krw INT COMMENT 'í”„ë¡œëª¨ì…˜ íŠ¹ê°€',

  -- ìµœì†Œ ìˆ™ë°•ì¼
  min_stay_nights INT DEFAULT 1,

  -- íŒë§¤ ì œì–´
  is_available BOOLEAN DEFAULT TRUE,
  close_out_reason VARCHAR(200) COMMENT 'íŒë§¤ ì¤‘ì§€ ì‚¬ìœ  (ì²­ì†Œ/ìˆ˜ë¦¬/ì´ë²¤íŠ¸)',

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  UNIQUE KEY unique_room_date (room_id, date),
  INDEX idx_date (date),
  INDEX idx_available (is_available, available_rooms),
  INDEX idx_room_date_range (room_id, date),

  FOREIGN KEY (room_id) REFERENCES rooms(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

-- ìš”ê¸ˆ ì •ì±… í…Œì´ë¸” (ì‹œì¦Œë³„/ìš”ì¼ë³„)
CREATE TABLE IF NOT EXISTS pricing_rules (
  id INT AUTO_INCREMENT PRIMARY KEY,

  room_id INT NOT NULL,
  rule_name VARCHAR(100) NOT NULL,

  -- ì ìš© ê¸°ê°„
  start_date DATE NOT NULL,
  end_date DATE NOT NULL,

  -- ì ìš© ìš”ì¼ (ë¹„íŠ¸ë§ˆìŠ¤í¬: ì›”=1, í™”=2, ìˆ˜=4...)
  day_of_week_mask INT DEFAULT 127 COMMENT 'ì›”-ì¼ ì „ì²´=127',

  -- ê°€ê²© ì¡°ì •
  price_type ENUM('fixed', 'markup', 'discount') NOT NULL,
  price_value INT NOT NULL,

  priority INT DEFAULT 0 COMMENT 'ìš°ì„ ìˆœìœ„ (ë†’ì„ìˆ˜ë¡ ìš°ì„ )',
  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,

  INDEX idx_room (room_id),
  INDEX idx_dates (start_date, end_date),
  INDEX idx_active (is_active),

  FOREIGN KEY (room_id) REFERENCES rooms(id) ON DELETE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;
```

#### 2.2 ì¬ê³  ì´ˆê¸°í™” ìŠ¤í¬ë¦½íŠ¸

**íŒŒì¼**: `api/admin/accommodation/init-calendar.js`

```javascript
// POST /api/admin/accommodation/init-calendar
// íŠ¹ì • ê¸°ê°„ì˜ ìº˜ë¦°ë” ì¬ê³  ìë™ ìƒì„±
// ì˜ˆ: 2025ë…„ ì „ì²´ ë˜ëŠ” í–¥í›„ 1ë…„
```

#### 2.3 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`api/accommodation/availability.js`**
   - ì²´í¬ì¸/ì²´í¬ì•„ì›ƒ ë‚ ì§œë¡œ ì˜ˆì•½ ê°€ëŠ¥ ê°ì‹¤ ì¡°íšŒ
   - ë‚ ì§œë³„ ê°€ê²© ê³„ì‚°

2. **`api/accommodation/calendar/[roomId].js`**
   - íŠ¹ì • ê°ì‹¤ì˜ ì›”ë³„ ìº˜ë¦°ë” ë°ì´í„°
   - ì˜ˆì•½ ê°€ëŠ¥ ì—¬ë¶€ + ê°€ê²© í‘œì‹œ

3. **`api/admin/accommodation/inventory.js`**
   - ê´€ë¦¬ììš© ì¬ê³  ëŒ€ëŸ‰ ìˆ˜ì •
   - íŠ¹ì • ê¸°ê°„ ì¼ê´„ ê°€ê²© ë³€ê²½
   - íŒë§¤ ì¤‘ì§€ ì„¤ì •

4. **`api/vendor/accommodation/calendar.js`**
   - ì—…ì²´ìš© ìº˜ë¦°ë” ê´€ë¦¬
   - ë‚ ì§œë³„ ì¬ê³ /ê°€ê²© ìˆ˜ì •

#### 2.4 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/accommodation/CalendarPicker.tsx`**
   - ì²´í¬ì¸/ì²´í¬ì•„ì›ƒ ë‚ ì§œ ì„ íƒ
   - ì˜ˆì•½ ë¶ˆê°€ëŠ¥í•œ ë‚ ì§œ ë¹„í™œì„±í™”
   - ê°€ê²© í‘œì‹œ

2. **`components/accommodation/RoomAvailabilityCalendar.tsx`**
   - ì›”ë³„ ìº˜ë¦°ë” ë·°
   - ì¬ê³  í˜„í™© ìƒ‰ìƒ í‘œì‹œ (ì—¬ìœ /ë³´í†µ/ë§ˆê°/ë¶ˆê°€)

3. **`components/admin/AccommodationInventoryManager.tsx`**
   - ê´€ë¦¬ììš© ìº˜ë¦°ë” í¸ì§‘ ë„êµ¬
   - ë“œë˜ê·¸ë¡œ ê¸°ê°„ ì„ íƒ â†’ ê°€ê²©/ì¬ê³  ì¼ê´„ ìˆ˜ì •

4. **`components/vendor/VendorCalendarManager.tsx`**
   - ì—…ì²´ìš© ê°„ë‹¨í•œ ìº˜ë¦°ë” ê´€ë¦¬

#### 2.5 ì¬ê³  ì ê¸ˆ ì‹œìŠ¤í…œ

**íŒŒì¼**: `api/accommodation/lock-inventory.js`

```javascript
// ì˜ˆì•½ í”„ë¡œì„¸ìŠ¤ ì¤‘ ì¬ê³  ì„ì‹œ ì ê¸ˆ (10ë¶„)
// ê²°ì œ ì™„ë£Œ ì‹œ í™•ì •, ì·¨ì†Œ/ì‹œê°„ì´ˆê³¼ ì‹œ í•´ì œ
```

#### 2.6 í†µí•© ì§€ì 

**ìˆ˜ì •í•  íŒŒì¼**:

1. **`components/pages/HotelDetailPage.tsx`**
   - ìº˜ë¦°ë” ë‚ ì§œ ì„ íƒê¸° ì¶”ê°€
   - ì„ íƒí•œ ë‚ ì§œì˜ ê°€ê²© ì‹¤ì‹œê°„ í‘œì‹œ

2. **`components/admin/AccommodationManagement.tsx`**
   - "ì¬ê³  ê´€ë¦¬" íƒ­ ì¶”ê°€

3. **`api/accommodation/book.js`**
   - ì˜ˆì•½ ì‹œ ì¬ê³  ì°¨ê° ë¡œì§ ì¶”ê°€
   - ì¬ê³  ë¶€ì¡± ì‹œ ì˜ˆì•½ ì°¨ë‹¨

---

## Phase 3: ì—¬í–‰ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•

### ğŸ“Œ ëª©í‘œ
íˆ¬ì–´ íŒ¨í‚¤ì§€ ì˜ˆì•½, ì¼ì • ê´€ë¦¬, QR ë°”ìš°ì²˜ ë°œê¸‰, ê°€ì´ë“œ ë°°ì •

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 3.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/create-tour-system.sql`

```sql
-- 1. íˆ¬ì–´ íŒ¨í‚¤ì§€ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS tour_packages (
  id INT AUTO_INCREMENT PRIMARY KEY,

  listing_id INT NOT NULL,
  vendor_id INT NOT NULL,

  -- ê¸°ë³¸ ì •ë³´
  package_code VARCHAR(50) UNIQUE NOT NULL,
  package_name VARCHAR(200) NOT NULL,
  description TEXT,

  -- ê¸°ê°„
  duration_days INT NOT NULL COMMENT '2ë°•3ì¼ì˜ 3',
  duration_nights INT NOT NULL COMMENT '2ë°•3ì¼ì˜ 2',

  -- ì¼ì •
  itinerary JSON NOT NULL COMMENT '[{"day": 1, "title": "...", "activities": [...]}]',

  -- í¬í•¨/ë¶ˆí¬í•¨ ì‚¬í•­
  included JSON COMMENT '["ì™•ë³µí•­ê³µ", "í˜¸í…”", "ì¡°ì‹", "ì…ì¥ê¶Œ"]',
  excluded JSON COMMENT '["ì ì‹¬/ì €ë…", "ì„ íƒê´€ê´‘", "ê°œì¸ê²½ë¹„"]',

  -- ì¶œë°œ ì •ë³´
  meeting_point VARCHAR(500),
  meeting_time TIME,
  departure_location VARCHAR(200) COMMENT 'ì¶œë°œì§€ (ì„œìš¸/ë¶€ì‚°/ì œì£¼)',

  -- ì¸ì› ë° ê°€ê²©
  min_participants INT DEFAULT 10,
  max_participants INT DEFAULT 30,
  price_adult_krw INT NOT NULL,
  price_child_krw INT,
  price_infant_krw INT,

  -- ì´ë¯¸ì§€
  thumbnail_url VARCHAR(500),
  images JSON,

  -- ì¶”ê°€ ì •ë³´
  difficulty ENUM('easy', 'moderate', 'hard') DEFAULT 'easy',
  tags JSON COMMENT '["ê°€ì¡±ì—¬í–‰", "íë§", "SNSëª…ì†Œ"]',

  is_active BOOLEAN DEFAULT TRUE,
  display_order INT DEFAULT 0,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_listing (listing_id),
  INDEX idx_vendor (vendor_id),
  INDEX idx_code (package_code),
  INDEX idx_active (is_active),

  FOREIGN KEY (listing_id) REFERENCES listings(id) ON DELETE CASCADE
);

-- 2. íˆ¬ì–´ ì¶œë°œ ì¼ì • (ìŠ¬ë¡¯)
CREATE TABLE IF NOT EXISTS tour_schedules (
  id INT AUTO_INCREMENT PRIMARY KEY,

  package_id INT NOT NULL,

  -- ì¶œë°œì¼
  departure_date DATE NOT NULL,
  departure_time TIME NOT NULL,

  -- ê°€ì´ë“œ
  guide_id INT COMMENT 'users í…Œì´ë¸”ì˜ ê°€ì´ë“œ',
  guide_name VARCHAR(100),
  guide_phone VARCHAR(50),
  guide_language VARCHAR(50) DEFAULT 'ko',

  -- ì •ì›
  max_participants INT NOT NULL,
  current_participants INT DEFAULT 0,
  min_participants INT DEFAULT 10 COMMENT 'ìµœì†Œ ì¶œë°œ ì¸ì›',

  -- ìƒíƒœ
  status ENUM('scheduled', 'confirmed', 'full', 'canceled') DEFAULT 'scheduled',
  cancelation_reason TEXT,

  -- ê°€ê²© (ë™ì  ì¡°ì • ê°€ëŠ¥)
  price_adult_krw INT,
  price_child_krw INT,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_package (package_id),
  INDEX idx_departure (departure_date, departure_time),
  INDEX idx_status (status),
  INDEX idx_guide (guide_id),

  FOREIGN KEY (package_id) REFERENCES tour_packages(id) ON DELETE CASCADE
);

-- 3. íˆ¬ì–´ ì˜ˆì•½
CREATE TABLE IF NOT EXISTS tour_bookings (
  id INT AUTO_INCREMENT PRIMARY KEY,

  booking_number VARCHAR(50) UNIQUE NOT NULL,
  schedule_id INT NOT NULL,
  user_id INT NOT NULL,

  -- ì°¸ê°€ì ì •ë³´
  participants JSON NOT NULL COMMENT '[{"name": "í™ê¸¸ë™", "age": 35, "phone": "010-1234-5678", "type": "adult"}]',
  adult_count INT DEFAULT 0,
  child_count INT DEFAULT 0,
  infant_count INT DEFAULT 0,

  -- ê°€ê²©
  total_price_krw INT NOT NULL,

  -- ë°”ìš°ì²˜
  voucher_code VARCHAR(50) UNIQUE,
  qr_code TEXT,

  -- ì²´í¬ì¸
  checked_in_at DATETIME,
  checked_in_by VARCHAR(100) COMMENT 'ê°€ì´ë“œëª…',

  -- ìƒíƒœ
  status ENUM('pending', 'confirmed', 'checked_in', 'completed', 'canceled', 'no_show') DEFAULT 'pending',
  payment_status ENUM('pending', 'paid', 'refunded') DEFAULT 'pending',

  -- íŠ¹ë³„ ìš”ì²­
  special_requests TEXT,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_schedule (schedule_id),
  INDEX idx_user (user_id),
  INDEX idx_booking_number (booking_number),
  INDEX idx_voucher (voucher_code),
  INDEX idx_status (status),

  FOREIGN KEY (schedule_id) REFERENCES tour_schedules(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### 3.2 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **íˆ¬ì–´ ì¡°íšŒ**
   - `api/tour/packages.js` - íŒ¨í‚¤ì§€ ëª©ë¡
   - `api/tour/packages/[id].js` - íŒ¨í‚¤ì§€ ìƒì„¸
   - `api/tour/schedules/[packageId].js` - ì¶œë°œ ì¼ì • ì¡°íšŒ

2. **ì˜ˆì•½**
   - `api/tour/book.js` - íˆ¬ì–´ ì˜ˆì•½ ìƒì„±
   - `api/tour/bookings/[id].js` - ì˜ˆì•½ ìƒì„¸ ì¡°íšŒ
   - `api/tour/voucher/[bookingId].js` - ë°”ìš°ì²˜ ì¡°íšŒ/QR ìƒì„±

3. **ì²´í¬ì¸**
   - `api/tour/check-in.js` - íˆ¬ì–´ ì‹œì‘ ì²´í¬ì¸ (ê°€ì´ë“œìš©)
   - `api/tour/verify-voucher.js` - QR ë°”ìš°ì²˜ ê²€ì¦

4. **ê´€ë¦¬**
   - `api/admin/tour/packages.js` - íŒ¨í‚¤ì§€ ê´€ë¦¬
   - `api/admin/tour/schedules.js` - ì¼ì • ê´€ë¦¬
   - `api/vendor/tour/bookings.js` - ì—…ì²´ ì˜ˆì•½ ê´€ë¦¬

#### 3.3 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/pages/TourPackageDetailPage.tsx`** (ìƒˆë¡œ ìƒì„±)
   - íŒ¨í‚¤ì§€ ì¼ì • í‘œì‹œ
   - í¬í•¨/ë¶ˆí¬í•¨ ì‚¬í•­
   - ì¶œë°œ ë‚ ì§œ ì„ íƒ
   - ì¸ì› ì„ íƒ (ì„±ì¸/ì•„ë™/ìœ ì•„)

2. **`components/tour/TourItinerary.tsx`**
   - ì¼ì •í‘œ UI (Day 1, Day 2...)

3. **`components/tour/TourBookingForm.tsx`**
   - ì°¸ê°€ì ì •ë³´ ì…ë ¥ í¼

4. **`components/tour/TourVoucher.tsx`**
   - ë°”ìš°ì²˜ í‘œì‹œ + QR ì½”ë“œ

5. **`components/admin/TourManagement.tsx`**
   - ê´€ë¦¬ììš© íˆ¬ì–´ ê´€ë¦¬

---

## Phase 4: ìŒì‹ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•

### ğŸ“Œ ëª©í‘œ
ì‹ë‹¹ ë©”ë‰´ ê´€ë¦¬, ì˜ˆì•½/í¬ì¥/ë§¤ì¥ ì£¼ë¬¸, í…Œì´ë¸” QR ì£¼ë¬¸, ì£¼ë¬¸ ìƒíƒœ ì¶”ì 

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 4.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/create-food-system.sql`

```sql
-- 1. ìŒì‹ì  í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS restaurants (
  id INT AUTO_INCREMENT PRIMARY KEY,

  listing_id INT NOT NULL,
  vendor_id INT NOT NULL,

  -- ê¸°ë³¸ ì •ë³´
  restaurant_code VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(200) NOT NULL,
  description TEXT,

  -- ìŒì‹ ë¶„ë¥˜
  cuisine_type VARCHAR(100) COMMENT 'í•œì‹/ì¤‘ì‹/ì¼ì‹/ì–‘ì‹/ì¹´í˜',
  food_categories JSON COMMENT '["í•œì‹-ì°Œê°œ", "í•œì‹-êµ¬ì´", "ë¶„ì‹"]',

  -- ìœ„ì¹˜
  address VARCHAR(500),
  latitude DECIMAL(10, 8),
  longitude DECIMAL(11, 8),

  -- ì—°ë½ì²˜
  phone VARCHAR(50),

  -- ìš´ì˜ ì •ë³´
  operating_hours JSON COMMENT '{"mon": "11:00-21:00", "tue": "11:00-21:00", ...}',
  break_time JSON COMMENT '{"start": "15:00", "end": "17:00"}',
  last_order_time TIME COMMENT 'ë§ˆì§€ë§‰ ì£¼ë¬¸ ì‹œê°„',

  -- ì‹œì„¤
  table_count INT DEFAULT 0,
  seat_count INT DEFAULT 0,
  parking_available BOOLEAN DEFAULT FALSE,

  -- ì„œë¹„ìŠ¤ ì œê³µ
  accepts_reservations BOOLEAN DEFAULT FALSE COMMENT 'ì˜ˆì•½ ê°€ëŠ¥',
  accepts_takeout BOOLEAN DEFAULT TRUE COMMENT 'í¬ì¥ ê°€ëŠ¥',
  accepts_delivery BOOLEAN DEFAULT FALSE COMMENT 'ë°°ë‹¬ ê°€ëŠ¥',
  table_order_enabled BOOLEAN DEFAULT FALSE COMMENT 'í…Œì´ë¸” QR ì£¼ë¬¸',

  -- ì´ë¯¸ì§€
  thumbnail_url VARCHAR(500),
  images JSON,
  menu_images JSON COMMENT 'ë©”ë‰´íŒ ì‚¬ì§„',

  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_listing (listing_id),
  INDEX idx_vendor (vendor_id),
  INDEX idx_code (restaurant_code),
  INDEX idx_cuisine (cuisine_type),
  INDEX idx_location (latitude, longitude),

  FOREIGN KEY (listing_id) REFERENCES listings(id) ON DELETE CASCADE
);

-- 2. ë©”ë‰´ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS menus (
  id INT AUTO_INCREMENT PRIMARY KEY,

  restaurant_id INT NOT NULL,

  -- ë©”ë‰´ ì •ë³´
  menu_code VARCHAR(50),
  name VARCHAR(200) NOT NULL,
  description TEXT,
  category VARCHAR(100) COMMENT 'ë©”ì¸/ì‚¬ì´ë“œ/ìŒë£Œ/ë””ì €íŠ¸',

  -- ê°€ê²©
  price_krw INT NOT NULL,
  discount_price_krw INT COMMENT 'í• ì¸ê°€',

  -- ì˜µì…˜
  options JSON COMMENT '[{"name": "ë§µê¸°", "choices": ["ìˆœí•œë§›", "ë³´í†µ", "ë§¤ìš´ë§›"], "required": true}]',

  -- ì¬ê³ 
  is_available BOOLEAN DEFAULT TRUE,
  daily_limit INT COMMENT 'í•˜ë£¨ íŒë§¤ í•œì •',
  current_sold INT DEFAULT 0,

  -- ì´ë¯¸ì§€
  image_url VARCHAR(500),

  -- ì¶”ì²œ/ì¸ê¸°
  is_signature BOOLEAN DEFAULT FALSE COMMENT 'ëŒ€í‘œ ë©”ë‰´',
  is_popular BOOLEAN DEFAULT FALSE COMMENT 'ì¸ê¸° ë©”ë‰´',

  -- ì•Œë ˆë¥´ê¸°/ì‹ì´ì •ë³´
  allergens JSON COMMENT '["ë•…ì½©", "ìš°ìœ ", "ê³„ë€"]',
  spicy_level INT DEFAULT 0 COMMENT '0-5 (0=ì•ˆë§¤ì›€)',
  calories INT,

  display_order INT DEFAULT 0,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_restaurant (restaurant_id),
  INDEX idx_category (category),
  INDEX idx_available (is_available),
  INDEX idx_display (display_order),

  FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE CASCADE
);

-- 3. ìŒì‹ ì£¼ë¬¸ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS food_orders (
  id INT AUTO_INCREMENT PRIMARY KEY,

  order_number VARCHAR(50) UNIQUE NOT NULL,
  restaurant_id INT NOT NULL,
  user_id INT,

  -- ì£¼ë¬¸ íƒ€ì…
  order_type ENUM('dine_in', 'takeout', 'delivery') NOT NULL,

  -- ë§¤ì¥ ì‹ì‚¬
  table_number INT COMMENT 'í…Œì´ë¸” ë²ˆí˜¸',
  guest_count INT COMMENT 'ì¸ì› ìˆ˜',

  -- í¬ì¥/ë°°ë‹¬
  pickup_time DATETIME COMMENT 'í¬ì¥ í”½ì—… ì‹œê°„',
  delivery_address VARCHAR(500),

  -- ì£¼ë¬¸ ë‚´ì—­
  items JSON NOT NULL COMMENT '[{"menu_id": 1, "name": "ê¹€ì¹˜ì°Œê°œ", "quantity": 2, "price": 9000, "options": {...}}]',

  -- ê°€ê²©
  subtotal_krw INT NOT NULL,
  delivery_fee_krw INT DEFAULT 0,
  discount_krw INT DEFAULT 0,
  total_krw INT NOT NULL,

  -- íŠ¹ë³„ ìš”ì²­
  special_requests TEXT COMMENT 'ëœ ë§µê²Œ, ë°¥ ë§ì´',

  -- ìƒíƒœ
  status ENUM('pending', 'confirmed', 'preparing', 'ready', 'completed', 'canceled') DEFAULT 'pending',
  payment_status ENUM('pending', 'paid', 'refunded') DEFAULT 'pending',

  -- ì¡°ë¦¬ ì‹œê°„
  estimated_ready_time DATETIME,
  ready_at DATETIME COMMENT 'ì¡°ë¦¬ ì™„ë£Œ ì‹œê°„',

  -- í”½ì—…/ì™„ë£Œ
  picked_up_at DATETIME,
  completed_at DATETIME,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_restaurant (restaurant_id),
  INDEX idx_user (user_id),
  INDEX idx_order_number (order_number),
  INDEX idx_status (status),
  INDEX idx_order_type (order_type),
  INDEX idx_table (table_number, status),

  FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id) ON DELETE SET NULL
);

-- 4. í…Œì´ë¸” QR í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS restaurant_tables (
  id INT AUTO_INCREMENT PRIMARY KEY,

  restaurant_id INT NOT NULL,
  table_number INT NOT NULL,

  -- QR ì½”ë“œ
  qr_code TEXT,
  qr_url VARCHAR(500) COMMENT '/food/table-order/[restaurantId]/[tableNumber]',

  -- í…Œì´ë¸” ì •ë³´
  seat_capacity INT DEFAULT 4,
  location VARCHAR(100) COMMENT 'ì°½ê°€/í™€/ë£¸',

  -- í˜„ì¬ ìƒíƒœ
  status ENUM('available', 'occupied', 'reserved', 'cleaning') DEFAULT 'available',
  current_order_id INT,

  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  UNIQUE KEY unique_table (restaurant_id, table_number),
  INDEX idx_restaurant (restaurant_id),
  INDEX idx_status (status),

  FOREIGN KEY (restaurant_id) REFERENCES restaurants(id) ON DELETE CASCADE,
  FOREIGN KEY (current_order_id) REFERENCES food_orders(id) ON DELETE SET NULL
);
```

#### 4.2 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **ì‹ë‹¹ ì¡°íšŒ**
   - `api/food/restaurants.js` - ì‹ë‹¹ ëª©ë¡
   - `api/food/restaurants/[id].js` - ì‹ë‹¹ ìƒì„¸
   - `api/food/menus/[restaurantId].js` - ë©”ë‰´ ì¡°íšŒ

2. **ì£¼ë¬¸**
   - `api/food/order.js` - ì£¼ë¬¸ ìƒì„± (ì˜ˆì•½/í¬ì¥/ë°°ë‹¬)
   - `api/food/table-order/[restaurantId]/[tableNumber].js` - í…Œì´ë¸” QR ì£¼ë¬¸
   - `api/food/orders/[orderId].js` - ì£¼ë¬¸ ìƒì„¸ ì¡°íšŒ
   - `api/food/order-status/[orderId].js` - ì‹¤ì‹œê°„ ì£¼ë¬¸ ìƒíƒœ

3. **ì‹ë‹¹ ì˜ˆì•½**
   - `api/food/reservations.js` - ì˜ˆì•½ ìƒì„±
   - `api/food/reservations/[id]/cancel.js` - ì˜ˆì•½ ì·¨ì†Œ

4. **ê´€ë¦¬**
   - `api/vendor/food/orders.js` - ì—…ì²´ ì£¼ë¬¸ ê´€ë¦¬
   - `api/vendor/food/menus.js` - ë©”ë‰´ ê´€ë¦¬
   - `api/admin/food/restaurants.js` - ê´€ë¦¬ì ì‹ë‹¹ ê´€ë¦¬

#### 4.3 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/pages/RestaurantDetailPage.tsx`** (ìƒˆë¡œ ìƒì„±)
   - ì‹ë‹¹ ì •ë³´ + ë©”ë‰´íŒ
   - ì˜ˆì•½/í¬ì¥/ë°°ë‹¬ ì„ íƒ
   - ì¥ë°”êµ¬ë‹ˆ ê¸°ëŠ¥

2. **`components/food/MenuList.tsx`**
   - ì¹´í…Œê³ ë¦¬ë³„ ë©”ë‰´ í‘œì‹œ
   - ì˜µì…˜ ì„ íƒ ëª¨ë‹¬

3. **`components/food/TableOrderPage.tsx`**
   - í…Œì´ë¸” QR ìŠ¤ìº” í›„ ì£¼ë¬¸ í˜ì´ì§€
   - í…Œì´ë¸” ë²ˆí˜¸ ìë™ ì…ë ¥

4. **`components/food/OrderStatusTracker.tsx`**
   - ì‹¤ì‹œê°„ ì£¼ë¬¸ ìƒíƒœ (ì£¼ë¬¸ì ‘ìˆ˜ â†’ ì¡°ë¦¬ì¤‘ â†’ ì™„ë£Œ)

5. **`components/vendor/FoodOrderManager.tsx`**
   - ì—…ì²´ìš© ì£¼ë¬¸ ê´€ë¦¬ ëŒ€ì‹œë³´ë“œ
   - ì‹ ê·œ ì£¼ë¬¸ ì•Œë¦¼

---

## Phase 5: ì²´í—˜ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•

### ğŸ“Œ ëª©í‘œ
ì²´í—˜ í”„ë¡œê·¸ë¨ ìŠ¬ë¡¯ ì˜ˆì•½, ì „ì ë©´ì±…ë™ì˜ì„œ, ê¸°ìƒ API ì—°ë™ ìë™ ì·¨ì†Œ

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 5.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/create-experience-system.sql`

```sql
-- 1. ì²´í—˜ í”„ë¡œê·¸ë¨ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS experiences (
  id INT AUTO_INCREMENT PRIMARY KEY,

  listing_id INT NOT NULL,
  vendor_id INT NOT NULL,

  -- ê¸°ë³¸ ì •ë³´
  experience_code VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(200) NOT NULL,
  description TEXT,

  -- ì²´í—˜ ë¶„ë¥˜
  type VARCHAR(100) COMMENT 'ë‹¤ì´ë¹™/ì„œí•‘/íŒ¨ëŸ¬ê¸€ë¼ì´ë”©/ìŠ¹ë§ˆ/ìš”íŠ¸',
  category VARCHAR(100) COMMENT 'í•´ì–‘ìŠ¤í¬ì¸ /ë ˆì €/ë¬¸í™”ì²´í—˜',

  -- ë‚œì´ë„
  difficulty ENUM('easy', 'medium', 'hard', 'expert') DEFAULT 'easy',

  -- ì°¸ê°€ ì¡°ê±´
  min_age INT DEFAULT 7,
  max_age INT COMMENT 'ìƒí•œ ì—°ë ¹',
  min_height_cm INT,
  max_weight_kg INT,
  health_requirements TEXT COMMENT 'ì‹¬ì¥ì§ˆí™˜ì/ì„ì‚°ë¶€ ë¶ˆê°€',

  -- ì •ì›
  min_participants INT DEFAULT 1,
  max_participants INT NOT NULL,

  -- ì†Œìš” ì‹œê°„
  duration_minutes INT NOT NULL,

  -- ì•ˆì „
  safety_briefing_required BOOLEAN DEFAULT TRUE COMMENT 'ì•ˆì „êµìœ¡ í•„ìˆ˜',
  safety_video_url VARCHAR(500),
  waiver_required BOOLEAN DEFAULT TRUE COMMENT 'ë©´ì±…ë™ì˜ í•„ìˆ˜',
  waiver_template TEXT COMMENT 'ë©´ì±…ë™ì˜ì„œ ë‚´ìš©',

  -- ë‚ ì”¨ ì˜ì¡´
  weather_dependent BOOLEAN DEFAULT FALSE,
  weather_conditions JSON COMMENT '{"min_temp": 10, "max_wind_speed": 15, "no_rain": true}',

  -- ì¥ë¹„
  equipment_included JSON COMMENT '["ì ìˆ˜ë³µ", "ì‚°ì†Œí†µ", "í•€"]',
  equipment_rental_available BOOLEAN DEFAULT FALSE,

  -- ê°€ê²©
  price_krw INT NOT NULL,
  equipment_rental_price_krw INT,

  -- ì´ë¯¸ì§€
  thumbnail_url VARCHAR(500),
  images JSON,
  videos JSON COMMENT 'ì²´í—˜ ì˜ìƒ',

  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_listing (listing_id),
  INDEX idx_vendor (vendor_id),
  INDEX idx_code (experience_code),
  INDEX idx_type (type),
  INDEX idx_active (is_active),

  FOREIGN KEY (listing_id) REFERENCES listings(id) ON DELETE CASCADE
);

-- 2. ì²´í—˜ ìŠ¬ë¡¯ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS experience_slots (
  id INT AUTO_INCREMENT PRIMARY KEY,

  experience_id INT NOT NULL,

  -- ì¼ì •
  date DATE NOT NULL,
  start_time TIME NOT NULL,
  end_time TIME NOT NULL,

  -- ê°•ì‚¬/ê°€ì´ë“œ
  instructor_id INT,
  instructor_name VARCHAR(100),
  instructor_phone VARCHAR(50),

  -- ì •ì›
  max_participants INT NOT NULL,
  current_participants INT DEFAULT 0,

  -- ê¸°ìƒ ìƒíƒœ
  weather_status ENUM('good', 'caution', 'canceled') DEFAULT 'good',
  weather_checked_at DATETIME,
  weather_data JSON COMMENT 'ì˜¨ë„/í’ì†/ê°•ìˆ˜ëŸ‰',

  -- ìƒíƒœ
  status ENUM('scheduled', 'confirmed', 'full', 'canceled', 'completed') DEFAULT 'scheduled',
  cancelation_reason TEXT,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_experience (experience_id),
  INDEX idx_date_time (date, start_time),
  INDEX idx_status (status),
  INDEX idx_weather (weather_status),

  FOREIGN KEY (experience_id) REFERENCES experiences(id) ON DELETE CASCADE
);

-- 3. ì²´í—˜ ì˜ˆì•½ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS experience_bookings (
  id INT AUTO_INCREMENT PRIMARY KEY,

  booking_number VARCHAR(50) UNIQUE NOT NULL,
  slot_id INT NOT NULL,
  user_id INT NOT NULL,

  -- ì°¸ê°€ì ì •ë³´
  participants JSON NOT NULL COMMENT '[{"name": "í™ê¸¸ë™", "age": 30, "height": 175, "weight": 70}]',
  participant_count INT NOT NULL,

  -- ê°€ê²©
  total_price_krw INT NOT NULL,

  -- ì•ˆì „êµìœ¡
  safety_video_watched BOOLEAN DEFAULT FALSE,
  safety_video_watched_at DATETIME,

  -- ë©´ì±…ë™ì˜
  waiver_signed BOOLEAN DEFAULT FALSE,
  waiver_signed_at DATETIME,
  waiver_signature_data TEXT COMMENT 'Base64 ì„œëª… ì´ë¯¸ì§€',
  waiver_ip_address VARCHAR(45),

  -- ì¥ë¹„ ëŒ€ì—¬
  equipment_rental BOOLEAN DEFAULT FALSE,
  equipment_rental_items JSON,

  -- ë°”ìš°ì²˜
  voucher_code VARCHAR(50) UNIQUE,
  qr_code TEXT,

  -- ì²´í¬ì¸
  checked_in_at DATETIME,

  -- ìƒíƒœ
  status ENUM('pending', 'confirmed', 'checked_in', 'completed', 'canceled', 'weather_canceled') DEFAULT 'pending',
  payment_status ENUM('pending', 'paid', 'refunded') DEFAULT 'pending',

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_slot (slot_id),
  INDEX idx_user (user_id),
  INDEX idx_booking_number (booking_number),
  INDEX idx_voucher (voucher_code),
  INDEX idx_status (status),

  FOREIGN KEY (slot_id) REFERENCES experience_slots(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### 5.2 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **ì²´í—˜ ì¡°íšŒ**
   - `api/experience/list.js` - ì²´í—˜ ëª©ë¡
   - `api/experience/[id].js` - ì²´í—˜ ìƒì„¸
   - `api/experience/slots/[experienceId].js` - ì˜ˆì•½ ê°€ëŠ¥ ìŠ¬ë¡¯

2. **ì˜ˆì•½**
   - `api/experience/book.js` - ì˜ˆì•½ ìƒì„±
   - `api/experience/bookings/[id].js` - ì˜ˆì•½ ìƒì„¸
   - `api/experience/waiver.js` - ë©´ì±…ë™ì˜ì„œ í‘œì‹œ/ì„œëª…

3. **ì•ˆì „êµìœ¡**
   - `api/experience/safety-video/[bookingId].js` - ì•ˆì „ ì˜ìƒ URL
   - `api/experience/safety-complete.js` - ì‹œì²­ ì™„ë£Œ ê¸°ë¡

4. **ë‚ ì”¨ ì²´í¬**
   - `api/experience/weather-check.js` - ê¸°ìƒ API í™•ì¸
   - `api/experience/cancel-weather.js` - ê¸°ìƒ ì•…í™”ë¡œ ìë™ ì·¨ì†Œ

5. **ê´€ë¦¬**
   - `api/vendor/experience/bookings.js` - ì—…ì²´ ì˜ˆì•½ ê´€ë¦¬
   - `api/admin/experience/experiences.js` - ê´€ë¦¬ì ì²´í—˜ ê´€ë¦¬

#### 5.3 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/pages/ExperienceDetailPage.tsx`** (ìƒˆë¡œ ìƒì„±)
   - ì²´í—˜ ì„¤ëª… + ì•ˆì „ ìˆ˜ì¹™
   - ìŠ¬ë¡¯ ì„ íƒ ìº˜ë¦°ë”
   - ì°¸ê°€ì ì •ë³´ ì…ë ¥

2. **`components/experience/SafetyVideoPlayer.tsx`**
   - ì•ˆì „êµìœ¡ ì˜ìƒ (ê±´ë„ˆë›°ê¸° ë¶ˆê°€)
   - ì‹œì²­ ì™„ë£Œ í›„ ë‹¤ìŒ ë‹¨ê³„

3. **`components/experience/WaiverForm.tsx`**
   - ë©´ì±…ë™ì˜ì„œ í‘œì‹œ
   - ì „ì ì„œëª… íŒ¨ë“œ

4. **`components/experience/WeatherAlert.tsx`**
   - ê¸°ìƒ ì•…í™” ì•Œë¦¼
   - ìë™ ì·¨ì†Œ/í™˜ë¶ˆ ì•ˆë‚´

5. **`components/vendor/ExperienceBookingManager.tsx`**
   - ì—…ì²´ìš© ì˜ˆì•½ ê´€ë¦¬
   - ê¸°ìƒ í™•ì¸ ë²„íŠ¼

---

## Phase 6: í–‰ì‚¬ - ì „ì²´ ì‹œìŠ¤í…œ êµ¬ì¶•

### ğŸ“Œ ëª©í‘œ
ì¢Œì„ ì„ íƒ, ì „ì í‹°ì¼“ ë°œê¸‰, QR ì…ì¥ ê²Œì´íŠ¸ ì‹œìŠ¤í…œ

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 6.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/create-event-system.sql`

```sql
-- 1. í–‰ì‚¬ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS events (
  id INT AUTO_INCREMENT PRIMARY KEY,

  listing_id INT NOT NULL,
  vendor_id INT NOT NULL,

  -- ê¸°ë³¸ ì •ë³´
  event_code VARCHAR(50) UNIQUE NOT NULL,
  title VARCHAR(200) NOT NULL,
  description TEXT,

  -- í–‰ì‚¬ ë¶„ë¥˜
  event_type VARCHAR(100) COMMENT 'ì½˜ì„œíŠ¸/ì—°ê·¹/ë®¤ì§€ì»¬/ì¶•ì œ/ì „ì‹œ',
  genre VARCHAR(100) COMMENT 'í´ë˜ì‹/íŒ/ë½/ì½”ë¯¸ë””',

  -- ì¼ì‹œ
  start_datetime DATETIME NOT NULL,
  end_datetime DATETIME NOT NULL,
  doors_open_time TIME COMMENT 'ì…ì¥ ì‹œì‘ ì‹œê°„',

  -- ì¥ì†Œ
  venue_name VARCHAR(200) NOT NULL,
  venue_address VARCHAR(500),
  venue_latitude DECIMAL(10, 8),
  venue_longitude DECIMAL(11, 8),

  -- ì •ì›
  total_capacity INT NOT NULL,
  current_sold INT DEFAULT 0,

  -- ê´€ëŒ ë“±ê¸‰
  age_restriction VARCHAR(50) COMMENT 'ì „ì²´ê´€ëŒê°€/12ì„¸/15ì„¸/19ì„¸',

  -- ì¢Œì„ì œ ì—¬ë¶€
  has_seats BOOLEAN DEFAULT FALSE,

  -- ì¶œì—°ì§„
  performers JSON COMMENT '["ì•„í‹°ìŠ¤íŠ¸1", "ì•„í‹°ìŠ¤íŠ¸2"]',

  -- ê°€ê²© (ë¹„ì¢Œì„ì œ)
  general_price_krw INT,
  vip_price_krw INT,

  -- ì´ë¯¸ì§€
  poster_url VARCHAR(500),
  images JSON,

  -- ì¶”ê°€ ì •ë³´
  running_time_minutes INT,
  intermission BOOLEAN DEFAULT FALSE,
  parking_info TEXT,

  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_listing (listing_id),
  INDEX idx_vendor (vendor_id),
  INDEX idx_code (event_code),
  INDEX idx_type (event_type),
  INDEX idx_datetime (start_datetime),

  FOREIGN KEY (listing_id) REFERENCES listings(id) ON DELETE CASCADE
);

-- 2. ì¢Œì„ ë°°ì¹˜ë„ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS event_seats (
  id INT AUTO_INCREMENT PRIMARY KEY,

  event_id INT NOT NULL,

  -- ì¢Œì„ ì •ë³´
  section VARCHAR(50) NOT NULL COMMENT 'VIPì„/Rì„/Sì„/Aì„',
  row VARCHAR(10) NOT NULL COMMENT 'ì—´ (A, B, C...)',
  seat_number VARCHAR(10) NOT NULL COMMENT 'ì¢Œì„ ë²ˆí˜¸',

  -- ê°€ê²©
  price_krw INT NOT NULL,

  -- ìƒíƒœ
  status ENUM('available', 'reserved', 'sold', 'blocked') DEFAULT 'available',
  booking_id INT COMMENT 'ì˜ˆì•½ ID (ì„ì‹œ ì ê¸ˆ)',
  ticket_id INT COMMENT 'í‹°ì¼“ ID (íŒë§¤ ì™„ë£Œ)',

  -- ì„ì‹œ ì ê¸ˆ (10ë¶„)
  reserved_until DATETIME,

  -- ì¢Œì„ ì •ë³´
  is_wheelchair BOOLEAN DEFAULT FALSE COMMENT 'íœ ì²´ì–´ì„',
  is_companion BOOLEAN DEFAULT FALSE COMMENT 'ë™ë°˜ì„',

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  UNIQUE KEY unique_seat (event_id, section, row, seat_number),
  INDEX idx_event (event_id),
  INDEX idx_section (section),
  INDEX idx_status (status),
  INDEX idx_reserved (reserved_until),

  FOREIGN KEY (event_id) REFERENCES events(id) ON DELETE CASCADE
);

-- 3. ì „ì í‹°ì¼“ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS event_tickets (
  id INT AUTO_INCREMENT PRIMARY KEY,

  event_id INT NOT NULL,
  user_id INT NOT NULL,

  -- í‹°ì¼“ ì •ë³´
  ticket_number VARCHAR(50) UNIQUE NOT NULL,
  order_number VARCHAR(50) NOT NULL,

  -- ì¢Œì„ ì •ë³´ (ì¢Œì„ì œì¸ ê²½ìš°)
  seat_id INT,
  seat_info JSON COMMENT '{"section": "VIP", "row": "A", "seat": "12"}',

  -- í‹°ì¼“ íƒ€ì… (ë¹„ì¢Œì„ì œ)
  ticket_type VARCHAR(50) COMMENT 'VIP/ì¼ë°˜',

  -- ê°€ê²©
  price_krw INT NOT NULL,

  -- QR ì½”ë“œ
  qr_code TEXT NOT NULL,
  qr_url VARCHAR(500),

  -- ì…ì¥
  entry_scanned BOOLEAN DEFAULT FALSE,
  entry_scanned_at DATETIME,
  entry_gate VARCHAR(50),
  entry_scanned_by VARCHAR(100) COMMENT 'ê²Œì´íŠ¸ ì§ì›',

  -- ì–‘ë„
  transferred_to_user_id INT,
  transferred_at DATETIME,

  -- ìƒíƒœ
  status ENUM('active', 'used', 'canceled', 'refunded') DEFAULT 'active',
  payment_status ENUM('pending', 'paid', 'refunded') DEFAULT 'pending',

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_event (event_id),
  INDEX idx_user (user_id),
  INDEX idx_ticket_number (ticket_number),
  INDEX idx_order (order_number),
  INDEX idx_seat (seat_id),
  INDEX idx_status (status),

  FOREIGN KEY (event_id) REFERENCES events(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id),
  FOREIGN KEY (seat_id) REFERENCES event_seats(id) ON DELETE SET NULL
);
```

#### 6.2 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **í–‰ì‚¬ ì¡°íšŒ**
   - `api/event/list.js` - í–‰ì‚¬ ëª©ë¡
   - `api/event/[id].js` - í–‰ì‚¬ ìƒì„¸
   - `api/event/seats/[eventId].js` - ì¢Œì„ ë°°ì¹˜ë„ ì¡°íšŒ

2. **ì˜ˆì•½**
   - `api/event/book-seats.js` - ì¢Œì„ ì„ íƒ ì˜ˆì•½
   - `api/event/lock-seats.js` - ì¢Œì„ ì„ì‹œ ì ê¸ˆ (10ë¶„)
   - `api/event/tickets/[orderId].js` - í‹°ì¼“ ì¡°íšŒ

3. **ì…ì¥**
   - `api/event/gate-scan.js` - QR ì…ì¥ ìŠ¤ìº” (ê²Œì´íŠ¸ìš©)
   - `api/event/verify-ticket.js` - í‹°ì¼“ ìœ íš¨ì„± ê²€ì¦

4. **ê´€ë¦¬**
   - `api/vendor/event/tickets.js` - ì—…ì²´ í‹°ì¼“ ê´€ë¦¬
   - `api/vendor/event/gate-stats.js` - ì…ì¥ í†µê³„
   - `api/admin/event/events.js` - ê´€ë¦¬ì í–‰ì‚¬ ê´€ë¦¬

#### 6.3 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/pages/EventDetailPage.tsx`** (ìƒˆë¡œ ìƒì„±)
   - í–‰ì‚¬ ì •ë³´ + ì¶œì—°ì§„
   - ì¢Œì„ ì„ íƒ ë˜ëŠ” ì¼ë°˜ í‹°ì¼“ ì„ íƒ

2. **`components/event/SeatMap.tsx`**
   - ì¢Œì„ ë°°ì¹˜ë„ UI
   - ì„ íƒí•œ ì¢Œì„ ì‹¤ì‹œê°„ ë°˜ì˜

3. **`components/event/TicketDisplay.tsx`**
   - ì „ì í‹°ì¼“ í‘œì‹œ
   - QR ì½”ë“œ í¬ê²Œ ë³´ê¸°

4. **`components/event/GateScannerPage.tsx`**
   - ê²Œì´íŠ¸ ì§ì›ìš© QR ìŠ¤ìº” í˜ì´ì§€
   - ìŠ¤ìº” ê²°ê³¼ í‘œì‹œ (âœ… ìœ íš¨ / âŒ ì´ë¯¸ ì‚¬ìš©)

5. **`components/vendor/EventGateManager.tsx`**
   - ì—…ì²´ìš© ì…ì¥ ê´€ë¦¬
   - ì‹¤ì‹œê°„ ì…ì¥ í˜„í™©

---

## Phase 7: ê´€ê´‘ì§€ - ì…ì¥ê¶Œ ì‹œìŠ¤í…œ êµ¬ì¶•

### ğŸ“Œ ëª©í‘œ
ì…ì¥ê¶Œ êµ¬ë§¤, ê²Œì´íŠ¸ QR ê²€ì¦ (ì˜¤ë””ì˜¤ ê°€ì´ë“œ ì œì™¸)

### ğŸ—‚ï¸ í•„ìš”í•œ ì‘ì—…

#### 7.1 ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ

**íŒŒì¼**: `database/create-attraction-system.sql`

```sql
-- 1. ê´€ê´‘ì§€ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS attractions (
  id INT AUTO_INCREMENT PRIMARY KEY,

  listing_id INT NOT NULL,
  vendor_id INT NOT NULL,

  -- ê¸°ë³¸ ì •ë³´
  attraction_code VARCHAR(50) UNIQUE NOT NULL,
  name VARCHAR(200) NOT NULL,
  description TEXT,

  -- ê´€ê´‘ì§€ ë¶„ë¥˜
  type VARCHAR(100) COMMENT 'ë°•ë¬¼ê´€/ìœ ì ì§€/í…Œë§ˆíŒŒí¬/ì „ì‹œê´€/ë™ë¬¼ì›',
  category VARCHAR(100) COMMENT 'ë¬¸í™”/ì—­ì‚¬/ìì—°/ë ˆì €',

  -- ìœ„ì¹˜
  address VARCHAR(500),
  latitude DECIMAL(10, 8),
  longitude DECIMAL(11, 8),

  -- ì—°ë½ì²˜
  phone VARCHAR(50),
  website VARCHAR(500),

  -- ìš´ì˜ ì •ë³´
  operating_hours JSON COMMENT '{"mon": "09:00-18:00", ...}',
  last_entry_time TIME COMMENT 'ë§ˆì§€ë§‰ ì…ì¥ ì‹œê°„',

  -- ì…ì¥ë£Œ
  admission_fee_adult INT NOT NULL,
  admission_fee_child INT,
  admission_fee_senior INT,
  admission_fee_infant INT DEFAULT 0,

  -- ë¬´ë£Œ ì…ì¥ì¼
  free_entry_days JSON COMMENT '["ë§¤ì›” ë§ˆì§€ë§‰ ìˆ˜ìš”ì¼", "ì–´ë¦°ì´ë‚ "]',

  -- ì£¼ì°¨
  parking_available BOOLEAN DEFAULT FALSE,
  parking_fee INT DEFAULT 0,
  parking_info TEXT,

  -- ì‹œì„¤
  wheelchair_accessible BOOLEAN DEFAULT FALSE,
  stroller_friendly BOOLEAN DEFAULT FALSE,
  pet_allowed BOOLEAN DEFAULT FALSE,

  -- ì´ë¯¸ì§€
  thumbnail_url VARCHAR(500),
  images JSON,

  -- ì¶”ê°€ ì •ë³´
  estimated_visit_duration_minutes INT COMMENT 'í‰ê·  ê´€ëŒ ì‹œê°„',
  highlights JSON COMMENT '["ëŒ€í‘œ ì „ì‹œë¬¼1", "í¬í† ì¡´"]',

  is_active BOOLEAN DEFAULT TRUE,

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_listing (listing_id),
  INDEX idx_vendor (vendor_id),
  INDEX idx_code (attraction_code),
  INDEX idx_type (type),
  INDEX idx_location (latitude, longitude),

  FOREIGN KEY (listing_id) REFERENCES listings(id) ON DELETE CASCADE
);

-- 2. ì…ì¥ê¶Œ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS entry_tickets (
  id INT AUTO_INCREMENT PRIMARY KEY,

  attraction_id INT NOT NULL,
  user_id INT NOT NULL,

  -- í‹°ì¼“ ì •ë³´
  ticket_number VARCHAR(50) UNIQUE NOT NULL,
  order_number VARCHAR(50) NOT NULL,

  -- í‹°ì¼“ íƒ€ì…
  ticket_type ENUM('adult', 'child', 'senior', 'infant', 'group') NOT NULL,
  ticket_count INT DEFAULT 1 COMMENT 'ë‹¨ì²´ê¶Œì˜ ê²½ìš° ì¸ì›ìˆ˜',

  -- ê°€ê²©
  price_krw INT NOT NULL,

  -- ìœ íš¨ ê¸°ê°„
  valid_date DATE NOT NULL,
  valid_until DATE COMMENT 'ê¸°ê°„ê¶Œì˜ ê²½ìš° ì¢…ë£Œì¼',

  -- QR ì½”ë“œ
  qr_code TEXT NOT NULL,
  qr_url VARCHAR(500),

  -- ì…ì¥
  entry_scanned BOOLEAN DEFAULT FALSE,
  entry_scanned_at DATETIME,
  entry_gate VARCHAR(50),
  entry_count INT DEFAULT 0 COMMENT 'ì¬ì…ì¥ íšŸìˆ˜',

  -- ìƒíƒœ
  status ENUM('active', 'used', 'expired', 'canceled', 'refunded') DEFAULT 'active',
  payment_status ENUM('pending', 'paid', 'refunded') DEFAULT 'pending',

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_attraction (attraction_id),
  INDEX idx_user (user_id),
  INDEX idx_ticket_number (ticket_number),
  INDEX idx_order (order_number),
  INDEX idx_valid_date (valid_date),
  INDEX idx_status (status),

  FOREIGN KEY (attraction_id) REFERENCES attractions(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id)
);

-- 3. ë‹¨ì²´ ì˜ˆì•½ í…Œì´ë¸”
CREATE TABLE IF NOT EXISTS group_bookings (
  id INT AUTO_INCREMENT PRIMARY KEY,

  attraction_id INT NOT NULL,
  user_id INT NOT NULL,

  -- ë‹¨ì²´ ì •ë³´
  booking_number VARCHAR(50) UNIQUE NOT NULL,
  group_name VARCHAR(200) COMMENT 'ë‹¨ì²´ëª… (í•™êµ/íšŒì‚¬)',
  participant_count INT NOT NULL,

  -- ë°©ë¬¸ ë‚ ì§œ
  visit_date DATE NOT NULL,
  visit_time TIME,

  -- ê°€ê²© (í• ì¸ ì ìš©)
  original_price_krw INT,
  discount_rate DECIMAL(5, 2) COMMENT 'í• ì¸ìœ¨ (%)',
  final_price_krw INT NOT NULL,

  -- ì—°ë½ì²˜
  contact_name VARCHAR(100),
  contact_phone VARCHAR(50),
  contact_email VARCHAR(200),

  -- íŠ¹ë³„ ìš”ì²­
  special_requests TEXT COMMENT 'ê°€ì´ë“œ ìš”ì²­/ì ì‹¬ ì¥ì†Œ ë¬¸ì˜',

  -- ìƒíƒœ
  status ENUM('pending', 'confirmed', 'completed', 'canceled') DEFAULT 'pending',
  payment_status ENUM('pending', 'paid', 'refunded') DEFAULT 'pending',

  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,

  INDEX idx_attraction (attraction_id),
  INDEX idx_user (user_id),
  INDEX idx_booking_number (booking_number),
  INDEX idx_visit_date (visit_date),
  INDEX idx_status (status),

  FOREIGN KEY (attraction_id) REFERENCES attractions(id) ON DELETE CASCADE,
  FOREIGN KEY (user_id) REFERENCES users(id)
);
```

#### 7.2 API ì—”ë“œí¬ì¸íŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **ê´€ê´‘ì§€ ì¡°íšŒ**
   - `api/tourist/list.js` - ê´€ê´‘ì§€ ëª©ë¡
   - `api/tourist/[id].js` - ê´€ê´‘ì§€ ìƒì„¸
   - `api/tourist/nearby.js` - ì£¼ë³€ ê´€ê´‘ì§€

2. **ì…ì¥ê¶Œ êµ¬ë§¤**
   - `api/tourist/tickets.js` - ì…ì¥ê¶Œ êµ¬ë§¤
   - `api/tourist/tickets/[orderId].js` - ì…ì¥ê¶Œ ì¡°íšŒ
   - `api/tourist/group-booking.js` - ë‹¨ì²´ ì˜ˆì•½

3. **ê²Œì´íŠ¸ ê²€ì¦**
   - `api/tourist/gate-verify.js` - QR ì…ì¥ ê²€ì¦
   - `api/tourist/tickets/[ticketNumber]/scan.js` - ìŠ¤ìº” ê¸°ë¡

4. **ê´€ë¦¬**
   - `api/vendor/tourist/tickets.js` - ì—…ì²´ ì…ì¥ê¶Œ ê´€ë¦¬
   - `api/vendor/tourist/gate-stats.js` - ì…ì¥ í†µê³„
   - `api/admin/tourist/attractions.js` - ê´€ë¦¬ì ê´€ê´‘ì§€ ê´€ë¦¬

#### 7.3 í”„ë¡ íŠ¸ì—”ë“œ ì»´í¬ë„ŒíŠ¸

**ìƒì„±í•  íŒŒì¼ë“¤**:

1. **`components/pages/AttractionDetailPage.tsx`** (ìƒˆë¡œ ìƒì„±)
   - ê´€ê´‘ì§€ ì†Œê°œ + í•˜ì´ë¼ì´íŠ¸
   - ì…ì¥ê¶Œ ì„ íƒ (ì„±ì¸/ì–´ë¦°ì´/ê²½ë¡œ)
   - ë°©ë¬¸ ë‚ ì§œ ì„ íƒ

2. **`components/tourist/TicketPurchaseForm.tsx`**
   - í‹°ì¼“ íƒ€ì… ë° ìˆ˜ëŸ‰ ì„ íƒ
   - ë‹¨ì²´ ì˜ˆì•½ ì˜µì…˜

3. **`components/tourist/EntryTicket.tsx`**
   - ì…ì¥ê¶Œ QR í‘œì‹œ
   - ìœ íš¨ ê¸°ê°„ í‘œì‹œ

4. **`components/tourist/GateVerifier.tsx`**
   - ê²Œì´íŠ¸ ì§ì›ìš© QR ìŠ¤ìº”
   - ì…ì¥ ê°€ëŠ¥ ì—¬ë¶€ í‘œì‹œ

5. **`components/vendor/TouristGateManager.tsx`**
   - ì—…ì²´ìš© ì…ì¥ ê´€ë¦¬
   - ì¼ë³„ ì…ì¥ í†µê³„

---

## ê°œë°œ ì²´í¬ë¦¬ìŠ¤íŠ¸

### âœ… Phase 1: ë ŒíŠ¸ì¹´ ì‚¬ê³  ì‹ ê³ 
- [ ] DB ìŠ¤í‚¤ë§ˆ ìƒì„± (`accident_reports` í…Œì´ë¸”)
- [ ] API 4ê°œ ìƒì„± (report, detail, list, admin)
- [ ] í”„ë¡ íŠ¸ì—”ë“œ 4ê°œ ì»´í¬ë„ŒíŠ¸
- [ ] ì•Œë¦¼ ì‹œìŠ¤í…œ ì—°ë™
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### âœ… Phase 2: ìˆ™ë°• ìº˜ë¦°ë” ì¬ê³ 
- [ ] DB ìŠ¤í‚¤ë§ˆ ìƒì„± (`room_availability`, `pricing_rules`)
- [ ] ì¬ê³  ì´ˆê¸°í™” API
- [ ] API 4ê°œ ìƒì„±
- [ ] ìº˜ë¦°ë” UI ì»´í¬ë„ŒíŠ¸
- [ ] ì¬ê³  ì ê¸ˆ ì‹œìŠ¤í…œ
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### âœ… Phase 3: ì—¬í–‰ ì „ì²´
- [ ] DB ìŠ¤í‚¤ë§ˆ 3ê°œ í…Œì´ë¸”
- [ ] API 12ê°œ ì´ìƒ ìƒì„±
- [ ] ìƒì„¸ í˜ì´ì§€ ìƒˆë¡œ ìƒì„±
- [ ] ë°”ìš°ì²˜ ì‹œìŠ¤í…œ
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### âœ… Phase 4: ìŒì‹ ì „ì²´
- [ ] DB ìŠ¤í‚¤ë§ˆ 4ê°œ í…Œì´ë¸”
- [ ] API 12ê°œ ì´ìƒ ìƒì„±
- [ ] ìƒì„¸ í˜ì´ì§€ ìƒˆë¡œ ìƒì„±
- [ ] í…Œì´ë¸” QR ì‹œìŠ¤í…œ
- [ ] ì£¼ë¬¸ ìƒíƒœ ì¶”ì 
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### âœ… Phase 5: ì²´í—˜ ì „ì²´
- [ ] DB ìŠ¤í‚¤ë§ˆ 3ê°œ í…Œì´ë¸”
- [ ] API 12ê°œ ì´ìƒ ìƒì„±
- [ ] ìƒì„¸ í˜ì´ì§€ ìƒˆë¡œ ìƒì„±
- [ ] ë©´ì±…ë™ì˜ ì‹œìŠ¤í…œ
- [ ] ê¸°ìƒ API ì—°ë™
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### âœ… Phase 6: í–‰ì‚¬ ì „ì²´
- [ ] DB ìŠ¤í‚¤ë§ˆ 3ê°œ í…Œì´ë¸”
- [ ] API 12ê°œ ì´ìƒ ìƒì„±
- [ ] ìƒì„¸ í˜ì´ì§€ ìƒˆë¡œ ìƒì„±
- [ ] ì¢Œì„ ì„ íƒ UI
- [ ] ê²Œì´íŠ¸ ìŠ¤ìº” ì‹œìŠ¤í…œ
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

### âœ… Phase 7: ê´€ê´‘ì§€
- [ ] DB ìŠ¤í‚¤ë§ˆ 3ê°œ í…Œì´ë¸”
- [ ] API 10ê°œ ìƒì„±
- [ ] ìƒì„¸ í˜ì´ì§€ ìƒˆë¡œ ìƒì„±
- [ ] ê²Œì´íŠ¸ ê²€ì¦ ì‹œìŠ¤í…œ
- [ ] ë‹¨ì²´ ì˜ˆì•½ ê¸°ëŠ¥
- [ ] í…ŒìŠ¤íŠ¸ ë° ë°°í¬

---

## ğŸ“ ê°œë°œ ì§„í–‰ ì‹œ ì£¼ì˜ì‚¬í•­

### 1. **ê¸°ì¡´ ì‹œìŠ¤í…œê³¼ì˜ í†µí•©**
- `listings` í…Œì´ë¸” ì—°ë™ í•„ìˆ˜
- `partners`/`vendors` í…Œì´ë¸” ì¬ì‚¬ìš©
- ê¸°ì¡´ ê²°ì œ/í™˜ë¶ˆ ì‹œìŠ¤í…œ í™œìš©

### 2. **ìƒì„¸ í˜ì´ì§€ ì»¤ìŠ¤í„°ë§ˆì´ì§•**
- ê° ì¹´í…Œê³ ë¦¬ë³„ ë³„ë„ DetailPage í•„ìš”
- ê³µí†µ ì»´í¬ë„ŒíŠ¸ ìµœëŒ€í•œ ì¬ì‚¬ìš©
- `CategoryDetailPage.tsx` ì°¸ê³ 

### 3. **QR/ë°”ìš°ì²˜ ì‹œìŠ¤í…œ í†µí•©**
- ëª¨ë“  ì¹´í…Œê³ ë¦¬ê°€ ìœ ì‚¬í•œ ë°”ìš°ì²˜ ì‹œìŠ¤í…œ ì‚¬ìš©
- `voucher_code`, `qr_code` ì»¬ëŸ¼ ì¼ê´€ì„± ìœ ì§€

### 4. **ê²°ì œ ì—°ë™**
- ê¸°ì¡´ í† ìŠ¤í˜ì´ë¨¼ì¸  ì‹œìŠ¤í…œ í™œìš©
- ì¹´í…Œê³ ë¦¬ë³„ `feature_flags` í™•ì¸

### 5. **ì ì§„ì  ë°°í¬**
- Phaseë³„ë¡œ ì™„ë£Œ í›„ ì¦‰ì‹œ ë°°í¬
- ì‚¬ìš©ì í”¼ë“œë°± ìˆ˜ì§‘ í›„ ë‹¤ìŒ Phase

---

## ğŸ”„ ë‚˜ì¤‘ì— ì°¸ê³ í•  íŒŒì¼ ìœ„ì¹˜

**ì´ ë¬¸ì„œ**: `DEVELOPMENT_ROADMAP.md` (í”„ë¡œì íŠ¸ ë£¨íŠ¸)

**ê´€ë ¨ ê¸°ì¡´ íŒŒì¼**:
- `database/` - ëª¨ë“  SQL ìŠ¤í‚¤ë§ˆ
- `api/rentcar/` - ë ŒíŠ¸ì¹´ API ì°¸ê³ ìš©
- `components/pages/RentcarVehicleDetailPage.tsx` - ìƒì„¸ í˜ì´ì§€ ì˜ˆì‹œ
- `api/lodging/` - ìˆ™ë°• API ì°¸ê³ ìš©

---

**ì‘ì„±ì**: Claude
**ìµœì¢… ì—…ë°ì´íŠ¸**: 2025-10-31
**ìƒíƒœ**: ê³„íš ìˆ˜ë¦½ ì™„ë£Œ, êµ¬í˜„ ëŒ€ê¸° ì¤‘
