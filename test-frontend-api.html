<!DOCTYPE html>
<html>
<head>
  <title>Test Frontend API</title>
  <script type="module">
    import { db } from './utils/database.ts';

    async function testStayCategory() {
      console.log('🧪 숙박 카테고리 테스트 시작');

      try {
        // 직접 DB 쿼리
        const result = await db.query(`
          SELECT l.*, c.slug as category_slug, c.name_ko as category_name
          FROM listings l
          LEFT JOIN categories c ON l.category_id = c.id
          WHERE l.is_published = 1 AND c.slug = ?
          ORDER BY l.view_count DESC, l.booking_count DESC
          LIMIT 20
        `, ['stay']);

        console.log('✅ 결과:', result);
        console.log('📊 상품 개수:', result.length);

        if (result.length > 0) {
          result.forEach((item, idx) => {
            console.log(`${idx + 1}. ${item.title} (${item.category_name})`);
          });
        } else {
          console.log('⚠️ 숙박 상품이 없습니다');
        }

        document.getElementById('result').innerHTML = `
          <h2>숙박 상품: ${result.length}개</h2>
          <ul>
            ${result.map(item => `<li>${item.title} - ${item.price_from}원</li>`).join('')}
          </ul>
        `;

      } catch (error) {
        console.error('❌ 오류:', error);
        document.getElementById('result').innerHTML = `<p style="color: red;">오류: ${error.message}</p>`;
      }
    }

    // 페이지 로드 시 실행
    window.addEventListener('DOMContentLoaded', testStayCategory);
  </script>
</head>
<body>
  <h1>숙박 카테고리 API 테스트</h1>
  <div id="result">로딩 중...</div>
</body>
</html>
