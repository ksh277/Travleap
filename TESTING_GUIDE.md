# 🧪 완전한 테스트 가이드

## 목차
1. [PMS 숙박 상품 등록 테스트](#1-pms-숙박-상품-등록-테스트)
2. [카테고리 페이지 표시 확인](#2-카테고리-페이지-표시-확인)
3. [상세 페이지 확인](#3-상세-페이지-확인)
4. [렌트카 시스템 테스트](#4-렌트카-시스템-테스트)
5. [예약 플로우 테스트](#5-예약-플로우-테스트)
6. [오류 체크리스트](#6-오류-체크리스트)

---

## 1. PMS 숙박 상품 등록 테스트

### 📌 목표
PMS API 연동으로 호텔 정보를 자동으로 불러와서 상품으로 등록

### ✅ 테스트 절차

#### Step 1: 관리자 로그인
```bash
# 브라우저 콘솔에서 실행
adminLogin()
```
- URL이 `/admin`으로 이동되는지 확인
- "상품 관리" 탭이 보이는지 확인

#### Step 2: PMS 연동 모달 열기
1. "상품 관리" 탭 클릭
2. "+ 상품 추가" 버튼 클릭
3. 카테고리를 "숙박"으로 선택
4. "PMS 연동" 버튼 클릭 (모달이 열림)

#### Step 3: 테스트 데이터 로드
1. **"테스트 데이터 사용"** 버튼 클릭
2. 확인사항:
   - ✅ "✅ 테스트 데이터가 로드되었습니다!" 토스트 메시지
   - ✅ 호텔 정보 표시: "신안 비치 호텔"
   - ✅ 3개 객실 타입 표시:
     - Deluxe Double - 120,000원
     - Family Suite - 250,000원
     - Standard Twin - 90,000원

#### Step 4: 폼에 적용
1. **"폼에 적용하기"** 버튼 클릭
2. 모달이 닫히면서 상품 추가 폼에 자동으로 데이터가 채워짐
3. 확인사항:
   - ✅ 제목: "신안 비치 호텔"
   - ✅ 카테고리: "숙박"
   - ✅ 위치: "전라남도 신안군 압해읍"
   - ✅ 설명: 호텔 설명 텍스트
   - ✅ 이미지: 2개 URL
   - ✅ 가격: "120000" (첫 번째 객실 가격)
   - ✅ 하이라이트 3개:
     - "Deluxe Double - 120,000원 (최대 2명)"
     - "Family Suite - 250,000원 (최대 4명)"
     - "Standard Twin - 90,000원 (최대 2명)"

#### Step 5: 상품 추가 (DB 저장)
1. 다른 필수 필드 확인/수정 (주소, 연락처 등은 선택사항)
2. **"상품 추가"** 버튼 클릭
3. 확인사항:
   - ✅ "✅ PMS 연동 숙박 상품이 등록되었습니다!" 토스트
   - ✅ 상품 목록에 "신안 비치 호텔" 추가됨
   - ✅ 폼이 초기화됨

#### Step 6: DB 확인 (콘솔 체크)
브라우저 개발자 도구 콘솔에서:
```javascript
// Listings 테이블 확인
db.findAll('listings').then(console.log)

// PMS 설정 확인
db.findAll('pms_configs').then(console.log)

// 객실 타입 확인
db.findAll('room_types').then(console.log)

// 객실 이미지 확인
db.findAll('room_media').then(console.log)

// 요금 플랜 확인
db.findAll('rate_plans').then(console.log)

// 재고 확인 (30일분)
db.findAll('room_inventory').then(console.log)
```

**기대 결과:**
- `listings`: 1개 row (hotel)
- `pms_configs`: 1개 row (vendor=cloudbeds)
- `room_types`: 3개 rows (각 객실 타입)
- `room_media`: 3개 rows (각 객실 이미지)
- `rate_plans`: 3개 rows (각 요금 플랜)
- `room_inventory`: 90개 rows (3객실 × 30일)

---

## 2. 카테고리 페이지 표시 확인

### 📌 목표
등록한 숙박 상품이 카테고리 페이지에 AccommodationCard로 표시되는지 확인

### ✅ 테스트 절차

#### Step 1: 숙박 카테고리 페이지 이동
```
http://localhost:5173/category/accommodation
```

#### Step 2: 상품 카드 확인
1. "신안 비치 호텔" 카드가 표시되는지 확인
2. AccommodationCard 스타일 확인:
   - ✅ 호텔 이미지 (aspect-[4/3])
   - ✅ "실시간 예약" 초록 배지 (PMS 연동)
   - ✅ 호텔명: "신안 비치 호텔"
   - ✅ 위치: "전라남도 신안군 압해읍"
   - ✅ 객실 타입 박스:
     ```
     객실 타입
     Deluxe Double - 120,000원 (최대 2명)
     Family Suite - 250,000원 (최대 4명)
     ```
   - ✅ 가격 범위: "₩90,000 ~ ₩250,000"
   - ✅ "1박 기준" 라벨
   - ✅ 하트 아이콘 (즐겨찾기)

#### Step 3: 인터랙션 테스트
1. 하트 아이콘 클릭 → 빨간색으로 변경
2. 카드 클릭 → `/accommodation/[ID]` 페이지로 이동

---

## 3. 상세 페이지 확인

### 📌 목표
AccommodationDetailPage가 객실 타입, 예약 폼과 함께 제대로 표시되는지 확인

### ✅ 테스트 절차

#### Step 1: 상세 페이지 접속
카테고리 페이지에서 카드 클릭 또는 직접 URL 접속:
```
http://localhost:5173/accommodation/[ID]
```
(ID는 DB에서 확인 또는 카드 클릭 시 URL)

#### Step 2: 페이지 구성 확인
##### 이미지 갤러리
- ✅ 메인 이미지 표시
- ✅ 좌/우 화살표 버튼 (이미지 2개 이상 시)
- ✅ 이미지 번호 표시 (1 / 2)
- ✅ 썸네일 클릭 시 메인 이미지 변경

##### 호텔 정보
- ✅ 호텔명: "신안 비치 호텔"
- ✅ 위치 아이콘 + "전라남도 신안군 압해읍"
- ✅ "실시간 예약" 초록 배지
- ✅ 설명 텍스트
- ✅ 하트/공유 버튼

##### 객실 선택 섹션
- ✅ "객실 선택" 제목
- ✅ 3개 객실 타입 카드:
  1. **Deluxe Double**
     - 최대 2명
     - ₩120,000 / 1박 기준
  2. **Family Suite**
     - 최대 4명
     - ₩250,000 / 1박 기준
  3. **Standard Twin**
     - 최대 2명
     - ₩90,000 / 1박 기준
- ✅ 객실 클릭 시 파란색 테두리 (선택 상태)

##### 편의시설
- ✅ WiFi, 에어컨, TV, 조식 아이콘

##### 예약 사이드바 (우측, sticky)
- ✅ "1박 기준" 가격: ₩90,000~
- ✅ 체크인 날짜 선택 (Popover calendar)
- ✅ 체크아웃 날짜 선택
- ✅ 인원 +/- 버튼
- ✅ "예약하기" 버튼
- ✅ "실시간 예약 - 즉시 확정됩니다" 텍스트

#### Step 3: 인터랙션 테스트
1. **객실 선택**:
   - Family Suite 클릭 → 파란색 테두리
   - Deluxe Double 클릭 → 파란색 테두리 이동

2. **날짜 선택**:
   - 체크인: 내일 날짜 선택
   - 체크아웃: 3일 후 선택
   - 과거 날짜 비활성화 확인

3. **인원 조정**:
   - '+' 버튼 클릭 → 3명으로 증가
   - '-' 버튼 클릭 → 2명으로 감소
   - 1명 미만 불가능 확인

4. **예약 버튼**:
   - 객실/날짜 미선택 시 클릭 → 오류 토스트
   - 모두 선택 후 클릭 → "예약 페이지로 이동합니다..." 토스트

5. **이미지 갤러리**:
   - 우측 화살표 → 다음 이미지
   - 좌측 화살표 → 이전 이미지
   - 썸네일 클릭 → 해당 이미지로 변경

---

## 4. 렌트카 시스템 테스트

### 📌 목표
렌트카는 DB에 상품이 없고, 실시간 검색 페이지가 표시되는지 확인

### ✅ 테스트 절차

#### Step 1: 렌트카 페이지 접속
```
http://localhost:5173/category/rentcar
```

#### Step 2: 페이지 구성 확인
- ✅ 제목: "렌트카 검색"
- ✅ 검색 폼 카드:
  - 픽업 위치 선택 (제주국제공항, 김포, 인천, 김해)
  - 반납 위치 선택 (+ "픽업 위치와 동일" 체크박스)
  - 픽업 날짜/시간 (달력 + 시간 선택)
  - 반납 날짜/시간
  - 운전자 나이 (21-25세, 26-65세, 66세 이상)
  - "차량 검색" 버튼
- ✅ 안내 카드 3개:
  - 다양한 픽업 위치
  - 실시간 가격 비교
  - 무료 취소 가능

#### Step 3: 검색 폼 유효성 검사
1. 아무 것도 입력하지 않고 "차량 검색" → "픽업 위치를 선택해주세요" 토스트
2. 픽업 위치만 선택 → "날짜를 선택해주세요" 토스트
3. 반납일을 픽업일보다 이전으로 → "반납일은 픽업일 이후여야 합니다" 토스트

#### Step 4: 정상 검색 (Mock 데이터 없음)
1. 모든 필드 입력:
   - 픽업: 제주국제공항
   - 반납: 제주국제공항 (동일 체크)
   - 픽업 날짜: 내일
   - 반납 날짜: 3일 후
   - 운전자 나이: 26-65세
2. "차량 검색" 클릭
3. 확인사항:
   - ✅ "검색 중..." 로딩 표시
   - ✅ 1.5초 후 "검색 결과가 없습니다" 표시
   - ✅ "다른 날짜나 위치로 다시 검색해보세요." 메시지

---

## 5. 예약 플로우 테스트

### 📌 목표
사용자가 숙박을 예약하는 전체 플로우 확인

### ✅ 테스트 절차

#### 일반 사용자 관점 테스트

1. **홈페이지** (`/`)
   - ✅ 숙박 카테고리 카드 클릭

2. **카테고리 페이지** (`/category/accommodation`)
   - ✅ 숙박 상품 카드 표시
   - ✅ AccommodationCard 스타일
   - ✅ 카드 클릭

3. **상세 페이지** (`/accommodation/[ID]`)
   - ✅ 객실 선택
   - ✅ 날짜 선택
   - ✅ 인원 선택
   - ✅ "예약하기" 클릭

4. **예약/결제 페이지** (추후 구현 예정)
   - 투숙객 정보 입력
   - 결제 수단 선택
   - 최종 확인

---

## 6. 오류 체크리스트

### 🐛 자주 발생할 수 있는 오류

#### PMS 상품 등록 관련
- [ ] PMS 모달에서 "폼에 적용하기" 후 데이터가 폼에 안 채워짐
  - **해결**: `handlePMSDataLoaded` 함수 확인
  - **확인**: `pmsFormData`와 `isPMSProduct` 플래그 설정 여부

- [ ] "상품 추가" 클릭 시 일반 listings 테이블에만 저장됨
  - **해결**: `handleAddProduct`에서 `isPMSProduct` 체크
  - **확인**: `saveProductToDB` 함수 호출 여부

- [ ] DB에 room_types, pms_configs 등이 저장 안 됨
  - **해결**: `utils/pms/admin-integration.ts`의 `saveProductToDB` 확인
  - **확인**: 콘솔에 "DB에 상품 저장 중..." 로그 출력 여부

#### 카테고리 페이지 관련
- [ ] 숙박 카테고리에서 일반 카드가 표시됨 (AccommodationCard 안 나옴)
  - **해결**: CategoryPage의 `isAccommodation` 조건 확인
  - **확인**: `category === 'accommodation' || category === 'stay'`

- [ ] AccommodationCard에 객실 타입이 안 보임
  - **해결**: `highlights` 배열에 객실 정보 저장 여부 확인
  - **확인**: `highlights` 형식: "객실명 - 가격원 (최대 N명)"

- [ ] 카드 클릭 시 `/detail/[ID]`로 가서 일반 페이지 표시
  - **해결**: AccommodationCard의 `navigate` 경로 확인
  - **확인**: `/accommodation/${listing.id}` 로 이동해야 함

#### 상세 페이지 관련
- [ ] AccommodationDetailPage가 안 뜨고 DetailPage가 뜸
  - **해결**: App.tsx 라우팅 순서 확인
  - **확인**: `/accommodation/:id` 라우트가 `/detail/:id`보다 먼저 정의

- [ ] 객실 타입 섹션이 비어있음
  - **해결**: `highlights` 파싱 로직 확인
  - **확인**: `listing.highlights?.filter(h => h.includes('원'))`

- [ ] 이미지가 안 보임
  - **해결**: `listing.images` 배열 확인
  - **확인**: Unsplash URL 형식 정확한지

#### 렌트카 페이지 관련
- [ ] `/category/rentcar` 접속 시 CategoryPage 표시
  - **해결**: App.tsx 라우팅 순서 확인
  - **확인**: `/category/rentcar` 라우트가 `/category/:category`보다 먼저

- [ ] 날짜 선택 시 달력이 안 뜸
  - **해결**: Popover, Calendar 컴포넌트 import 확인
  - **확인**: shadcn/ui 설치 여부

---

## 7. 성능 체크리스트

### ⚡ 최적화 확인 사항

- [ ] 이미지 로딩 속도
  - ImageWithFallback 컴포넌트 사용
  - Unsplash 이미지 크기 조절 (?w=800)

- [ ] 카테고리 페이지 로딩
  - 20개씩 페이지네이션
  - 무한 스크롤 동작

- [ ] 상세 페이지 반응성
  - 모바일 레이아웃 확인
  - 탭/모바일에서 sticky 사이드바

- [ ] 검색 성능
  - 렌트카 검색 debounce
  - 캐시 TTL 설정

---

## 8. 최종 체크리스트 (운영 전)

### ✅ 필수 확인 사항

#### 데이터베이스
- [ ] 모든 PMS 테이블 생성 확인 (room_types, pms_configs, etc.)
- [ ] Foreign key 제약조건 정상 작동
- [ ] 인덱스 설정 (listing_id, date 등)

#### UI/UX
- [ ] 모든 페이지 모바일 반응형 확인
- [ ] 로딩 상태 표시 (Spinner, Skeleton)
- [ ] 에러 처리 (Toast, Error boundary)
- [ ] 빈 상태 처리 (Empty state)

#### 기능
- [ ] PMS 상품 등록 완료
- [ ] 카테고리 페이지 표시 완료
- [ ] 상세 페이지 표시 완료
- [ ] 날짜 선택 완료
- [ ] 객실 선택 완료

#### 보안
- [ ] API Key 암호화 (현재는 빈 문자열)
- [ ] XSS 방지
- [ ] CSRF 토큰

#### 성능
- [ ] 이미지 최적화
- [ ] 코드 스플리팅
- [ ] 캐싱 전략

---

## 9. 테스트 시나리오 스크립트

### 🎬 시나리오 1: PMS 숙박 상품 전체 플로우

```bash
# 1. 관리자 로그인
adminLogin()

# 2. 상품 추가
- 상품 관리 → + 상품 추가
- 카테고리: 숙박 선택
- PMS 연동 버튼 클릭
- "테스트 데이터 사용" 클릭
- 3개 객실 확인
- "폼에 적용하기" 클릭
- "상품 추가" 클릭

# 3. 카테고리 페이지 확인
http://localhost:5173/category/accommodation
- AccommodationCard 확인
- 객실 타입 2개 표시 확인
- 가격 범위 확인

# 4. 상세 페이지 확인
- 카드 클릭
- 이미지 갤러리 확인
- 3개 객실 선택 카드 확인
- Family Suite 선택
- 체크인: 내일
- 체크아웃: 3일 후
- 인원: 2명
- "예약하기" 클릭
```

### 🎬 시나리오 2: 렌트카 검색 플로우

```bash
# 1. 렌트카 페이지 접속
http://localhost:5173/category/rentcar

# 2. 검색 폼 입력
- 픽업: 제주국제공항
- 반납: 제주국제공항 (동일 체크)
- 픽업 날짜: 내일
- 픽업 시간: 10:00
- 반납 날짜: 3일 후
- 반납 시간: 10:00
- 운전자 나이: 26-65세

# 3. 검색
- "차량 검색" 클릭
- 로딩 확인
- "검색 결과가 없습니다" 확인 (Mock 데이터 없음)
```

---

## 10. 트러블슈팅

### 문제: "상품이 카테고리 페이지에 안 보여요"

**해결 순서:**
1. DB 확인: `db.findAll('listings').then(console.log)`
2. `category` 필드가 "숙박"인지 확인
3. `is_active`와 `is_published`가 true인지 확인
4. CategoryPage의 필터 로직 확인
5. API 응답 확인: Network 탭에서 `/api/listings` 응답 확인

### 문제: "객실 타입이 안 보여요"

**해결 순서:**
1. `highlights` 배열에 데이터 있는지 확인
2. 형식이 "객실명 - 가격원 (최대 N명)" 맞는지 확인
3. AccommodationCard의 파싱 로직 확인: `.filter(h => h.includes('원'))`
4. DetailPage의 파싱 로직도 동일하게 확인

### 문제: "PMS 데이터가 DB에 안 들어가요"

**해결 순서:**
1. `handleAddProduct`에서 `isPMSProduct` 플래그 확인
2. `saveProductToDB` 함수 호출 로그 확인
3. 콘솔 에러 메시지 확인
4. DB 제약조건 에러 확인 (Foreign key, Not null 등)
5. 각 테이블별로 데이터 확인:
   ```javascript
   db.findAll('listings').then(console.log)
   db.findAll('pms_configs').then(console.log)
   db.findAll('room_types').then(console.log)
   ```

---

## 마무리

이 가이드를 따라 테스트하면:
1. ✅ PMS 숙박 상품 등록 완료
2. ✅ 카테고리 페이지에 AccommodationCard 표시
3. ✅ 상세 페이지에 객실 선택 + 예약 폼 표시
4. ✅ 렌트카 검색 페이지 작동
5. ✅ 모든 오류 사전 체크

**운영 전 최종 확인:**
- [ ] 실제 PMS API 연동 테스트 (CloudBeds, Opera 등)
- [ ] 실제 결제 테스트 (PG 연동)
- [ ] 부하 테스트 (동시 접속자 100명)
- [ ] 모바일 실기기 테스트 (iOS, Android)
- [ ] 보안 취약점 점검

**문제 발생 시:**
1. 이 가이드의 트러블슈팅 섹션 확인
2. 브라우저 콘솔 에러 메시지 확인
3. Network 탭에서 API 요청/응답 확인
4. DB 데이터 직접 확인
